<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cbmpy.CBModel &mdash; CBMPy User Guide v0.7</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.7.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within CBMPy User Guide v0.7"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="CBMPy User Guide v0.7" href="../../cbmpy.html" />
    <link rel="up" title="Module code" href="../index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for cbmpy.CBModel</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">CBMPy: CBModel module</span>
<span class="sd">=====================</span>
<span class="sd">PySCeS Constraint Based Modelling (http://cbmpy.sourceforge.net)</span>
<span class="sd">Copyright (C) 2009-2014 Brett G. Olivier, VU University Amsterdam, Amsterdam, The Netherlands</span>

<span class="sd">This program is free software: you can redistribute it and/or modify</span>
<span class="sd">it under the terms of the GNU General Public License as published by</span>
<span class="sd">the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">(at your option) any later version.</span>

<span class="sd">This program is distributed in the hope that it will be useful,</span>
<span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">GNU General Public License for more details.</span>

<span class="sd">You should have received a copy of the GNU General Public License</span>
<span class="sd">along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;</span>

<span class="sd">Author: Brett G. Olivier</span>
<span class="sd">Contact email: bgoli@users.sourceforge.net</span>
<span class="sd">Last edit: $Author: bgoli $ ($Id: CBModel.py 416 2016-02-23 16:12:23Z bgoli $)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c">## gets rid of &quot;invalid variable name&quot; info</span>
<span class="c"># pylint: disable=C0103</span>
<span class="c">## gets rid of &quot;line to long&quot; info</span>
<span class="c"># pylint: disable=C0301</span>
<span class="c">## use with caution: gets rid of module xxx has no member errors (run once enabled)</span>
<span class="c"># pylint: disable=E1101</span>

<span class="c"># preparing for Python 3 port</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="c">#from __future__ import unicode_literals</span>

<span class="kn">import</span> <span class="nn">numpy</span><span class="o">,</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">weakref</span><span class="o">,</span> <span class="nn">copy</span><span class="o">,</span> <span class="nn">json</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pickle</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cPickle</span> <span class="kn">as</span> <span class="nn">pickle</span>

<span class="n">HAVE_SYMPY</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sympy</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">7</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">HAVE_SYMPY</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">sympy</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">ERROR: SymPy version 0.7.5 or newer is required for symbolic matrix support.&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">HAVE_SYMPY</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">ERROR: SymPy version 0.7.5 or newer is required for symbolic matrix support.&#39;</span><span class="p">)</span>

<span class="n">HAVE_SCIPY</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">scipy</span>
    <span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">csr_matrix</span>
    <span class="n">HAVE_SCIPY</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">HAVE_SCIPY</span> <span class="o">=</span> <span class="bp">False</span>


<span class="c">#from .CBDataStruct import (StructMatrixLP, MIRIAMannotation, MIRIAMModelAnnotation)</span>
<span class="kn">from</span> <span class="nn">.CBDataStruct</span> <span class="kn">import</span> <span class="p">(</span><span class="n">StructMatrixLP</span><span class="p">,</span> <span class="n">MIRIAMannotation</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.CBCommon</span> <span class="kn">import</span> <span class="p">(</span><span class="n">checkChemFormula</span><span class="p">,</span> <span class="n">extractGeneIdsFromString</span><span class="p">,</span> <span class="n">binHash</span><span class="p">,</span> <span class="n">fixId</span><span class="p">,</span> <span class="n">checkId</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">.CBConfig</span> <span class="kn">import</span> <span class="n">__CBCONFIG__</span> <span class="k">as</span> <span class="n">__CBCONFIG__</span>
<span class="n">__DEBUG__</span> <span class="o">=</span> <span class="n">__CBCONFIG__</span><span class="p">[</span><span class="s">&#39;DEBUG&#39;</span><span class="p">]</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="n">__CBCONFIG__</span><span class="p">[</span><span class="s">&#39;VERSION&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="Fbase"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase">[docs]</a><span class="k">class</span> <span class="nc">Fbase</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for CB Model objects</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">annotation</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">compartment</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">miriam</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">notes</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">__TRASH__</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__objref__</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__metaid__</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__sbo_term__</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c">##  __pre__ = &#39;&#39;</span>
    <span class="c">##  __post__ = &#39;&#39;</span>


    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal method that should allow our weakrefs to be &#39;picklable&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s">&#39;__objref__&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cpy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">cpy</span><span class="p">[</span><span class="s">&#39;__objref__&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">return</span> <span class="n">cpy</span>

    <span class="k">def</span> <span class="nf">__setObjRef__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a weakref to another object</span>

<span class="sd">         - *o* the referred to object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__unsetObjRef__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        UnSets a weakref to another object</span>

<span class="sd">         - *o* the referred to object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="Fbase.getPid"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.getPid">[docs]</a>    <span class="k">def</span> <span class="nf">getPid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the object ID.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
</div>
<div class="viewcode-block" id="Fbase.getId"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.getId">[docs]</a>    <span class="k">def</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the object ID.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
</div>
<div class="viewcode-block" id="Fbase.getMetaId"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.getMetaId">[docs]</a>    <span class="k">def</span> <span class="nf">getMetaId</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the object metaId.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__metaid__</span> <span class="o">=</span> <span class="s">&#39;meta_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metaid__</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metaid__</span> <span class="o">=</span> <span class="s">&#39;meta_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metaid__</span>
</div>
<div class="viewcode-block" id="Fbase.getName"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.getName">[docs]</a>    <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the object name.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</div>
<div class="viewcode-block" id="Fbase.getNotes"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.getNotes">[docs]</a>    <span class="k">def</span> <span class="nf">getNotes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the object&#39;s notes</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">notes</span>
</div>
<div class="viewcode-block" id="Fbase.getAnnotations"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.getAnnotations">[docs]</a>    <span class="k">def</span> <span class="nf">getAnnotations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the object annotation dictionary</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span>
</div>
<div class="viewcode-block" id="Fbase.getAnnotation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.getAnnotation">[docs]</a>    <span class="k">def</span> <span class="nf">getAnnotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the object annotation associated with:</span>

<span class="sd">         - *key* the annotation key</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="Fbase.hasAnnotation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.hasAnnotation">[docs]</a>    <span class="k">def</span> <span class="nf">hasAnnotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a boolean representing the presence/absence of the key in the objext annotation</span>

<span class="sd">         - *key* the annotation key</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
</div>
<div class="viewcode-block" id="Fbase.setName"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.setName">[docs]</a>    <span class="k">def</span> <span class="nf">setName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the object name:</span>

<span class="sd">         - *name* the name string</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</div>
<div class="viewcode-block" id="Fbase.setNotes"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.setNotes">[docs]</a>    <span class="k">def</span> <span class="nf">setNotes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the object&#39;s notes:</span>

<span class="sd">         - *notes* the note string, should preferably be (X)HTML for SBML</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notes</span> <span class="o">=</span> <span class="n">notes</span>
</div>
<div class="viewcode-block" id="Fbase.setAnnotation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.setAnnotation">[docs]</a>    <span class="k">def</span> <span class="nf">setAnnotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set an objects annotation as a key : value pair.</span>

<span class="sd">         - *key* the annotation key</span>
<span class="sd">         - *value* the annotation value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">This class has no annotation field&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span> <span class="p">:</span> <span class="n">value</span><span class="p">})</span>
        <span class="c">#if type(value) != list:</span>
            <span class="c">#self.annotation.update({key : value})</span>
        <span class="c">#elif type(value) == list:</span>
            <span class="c">#if len(value) == 1:</span>
                <span class="c">#self.annotation.update({key : value[0]})</span>
            <span class="c">#else:</span>
                <span class="c">#value = [&#39;&amp;apos;{}&amp;apos;&#39;.format(str(v).strip()) for v in value]</span>
                <span class="c">#self.annotation.update({key : &#39;[&#39;+&#39;, &#39;.join(map(str, value))+&#39;]&#39;})</span>
                <span class="c">##self.annotation.update({key : str(json.dumps(value))})</span>
                <span class="c">##self.annotation.update({key : value})</span>
</div>
<div class="viewcode-block" id="Fbase.deleteAnnotation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.deleteAnnotation">[docs]</a>    <span class="k">def</span> <span class="nf">deleteAnnotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unsets (deltes) an objects annotation with key</span>

<span class="sd">         - *key* the annotation key</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">key</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Annotation key {} does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__checkId__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks the validity of the object id, raises a Runtime warning if not.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cntr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cntr</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s">&#39;_&#39;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">cntr</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s">&#39;_&#39;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> is an invalid character in id: </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                <span class="c">#raise RuntimeWarning(&#39;\n\&quot;{}\&quot; is an invalid character in id: \&quot;{}\&quot;&#39;.format(c, self.id))</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="n">cntr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="bp">True</span>

<div class="viewcode-block" id="Fbase.setPid"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.setPid">[docs]</a>    <span class="k">def</span> <span class="nf">setPid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the object Id</span>

<span class="sd">         - *fid* a valid c variable style id string</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">fid</span>
</div>
<div class="viewcode-block" id="Fbase.setId"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.setId">[docs]</a>    <span class="k">def</span> <span class="nf">setId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the object Id</span>

<span class="sd">         - *fid* a valid c variable style id string</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">fid</span>
</div>
<div class="viewcode-block" id="Fbase.setMetaId"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.setMetaId">[docs]</a>    <span class="k">def</span> <span class="nf">setMetaId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the object Id</span>

<span class="sd">         - *mid* [default=None] a valid c variable style metaid string, if None it will be set as meta+id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metaid__</span> <span class="o">=</span> <span class="s">&#39;meta_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metaid__</span> <span class="o">=</span> <span class="n">mid</span>
</div>
<div class="viewcode-block" id="Fbase.clone"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.clone">[docs]</a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a clone of this object. Cloning performs a deepcop on the object which will also clone</span>
<span class="sd">        any objects that exist as attributes of this object, in other words an independent copy of the</span>
<span class="sd">        original. If this is not the desired behaviour override this method when subclassing or implement</span>
<span class="sd">        your own.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Fbase.serialize"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.serialize">[docs]</a>    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serialize object, returns a string by default</span>

<span class="sd">         - *protocol* [default=0] serialize to a string or binary if required,</span>
<span class="sd">                      see pickle module documentation for details</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">protocol</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Fbase.serializeToDisk"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.serializeToDisk">[docs]</a>    <span class="k">def</span> <span class="nf">serializeToDisk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serialize to disk using pickle protocol:</span>

<span class="sd">         - *filename* the name of the output file</span>
<span class="sd">         - *protocol* [default=0] serialize to a string or binary if required,</span>
<span class="sd">                      see pickle module documentation for details</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">F</span> <span class="o">=</span> <span class="nb">file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">protocol</span><span class="p">)</span>
        <span class="n">F</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Fbase.addMIRIAMannotation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.addMIRIAMannotation">[docs]</a>    <span class="k">def</span> <span class="nf">addMIRIAMannotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qual</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">mid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a qualified MIRIAM annotation or entity:</span>

<span class="sd">         - *qual* a Biomodels biological qualifier e.g. &quot;is&quot; &quot;isEncodedBy&quot;</span>
<span class="sd">         - *entity* a MIRIAM resource entity e.g. &quot;ChEBI&quot;</span>
<span class="sd">         - *mid* the entity id e.g. CHEBI:17158 or fully qualifies url (if only_qual_uri)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span> <span class="o">=</span> <span class="n">MIRIAMannotation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span><span class="o">.</span><span class="n">addMIRIAMannotation</span><span class="p">(</span><span class="n">qual</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Fbase.addMIRIAMuri"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.addMIRIAMuri">[docs]</a>    <span class="k">def</span> <span class="nf">addMIRIAMuri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qual</span><span class="p">,</span> <span class="n">uri</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a qualified MIRIAM annotation or entity:</span>

<span class="sd">         - *qual* a Biomodels biological qualifier e.g. &quot;is&quot; &quot;isEncodedBy&quot;</span>
<span class="sd">         - *uri* the fully qualified entity id e.g. http://identifiers.org/chebi/CHEBI:12345 (no validity checking is done)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span> <span class="o">=</span> <span class="n">MIRIAMannotation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span><span class="o">.</span><span class="n">addIDorgURI</span><span class="p">(</span><span class="n">qual</span><span class="p">,</span> <span class="n">uri</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Fbase.getMIRIAMannotations"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.getMIRIAMannotations">[docs]</a>    <span class="k">def</span> <span class="nf">getMIRIAMannotations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of all MIRIAM annotations associated with this object</span>
<span class="sd">        or None of there are none defined.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span><span class="o">.</span><span class="n">getAllMIRIAMUris</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="Fbase.deleteMIRIAMannotation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.deleteMIRIAMannotation">[docs]</a>    <span class="k">def</span> <span class="nf">deleteMIRIAMannotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qual</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">mid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes a qualified MIRIAM annotation or entity:</span>

<span class="sd">         - *qual* a Biomodels biological qualifier e.g. &quot;is&quot; &quot;isEncodedBy&quot;</span>
<span class="sd">         - *entity* a MIRIAM resource entity e.g. &quot;ChEBI&quot;</span>
<span class="sd">         - *mid* the entity id e.g. CHEBI:17158</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span><span class="o">.</span><span class="n">deleteMIRIAMannotation</span><span class="p">(</span><span class="n">qual</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Fbase.getCompartmentId"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.getCompartmentId">[docs]</a>    <span class="k">def</span> <span class="nf">getCompartmentId</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the compartment id where this element is located</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compartment</span>
</div>
<div class="viewcode-block" id="Fbase.setCompartmentId"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.setCompartmentId">[docs]</a>    <span class="k">def</span> <span class="nf">setCompartmentId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compartment</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the compartment id where this element is located</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartment</span> <span class="o">=</span> <span class="n">compartment</span>
</div>
<div class="viewcode-block" id="Fbase.getSBOterm"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.getSBOterm">[docs]</a>    <span class="k">def</span> <span class="nf">getSBOterm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the SBO term for this object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sbo_term__</span>
</div>
<div class="viewcode-block" id="Fbase.setSBOterm"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Fbase.setSBOterm">[docs]</a>    <span class="k">def</span> <span class="nf">setSBOterm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sbo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the SBO term for this object.</span>

<span class="sd">         - *sbo* the SBOterm with format: SBO:nnnnnnn&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">sbo</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;SBO:&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">sbo</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">7</span><span class="p">,</span> <span class="s">&#39;SBOterm must have the form: SBO:nnnnnnn&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__sbo_term__</span> <span class="o">=</span> <span class="n">sbo</span>

</div></div>
<div class="viewcode-block" id="Model"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model">[docs]</a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Container for constraint based model, adds methods for manipulating:</span>

<span class="sd">     - objectives</span>
<span class="sd">     - constraints</span>
<span class="sd">     - reactions</span>
<span class="sd">     - species</span>
<span class="sd">     - compartments</span>
<span class="sd">     - groups</span>
<span class="sd">     - parameters</span>
<span class="sd">     - N a structmatrix object</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">prefix</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">suffix</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">objectives</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">obj_func</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">activeObjIdx</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">flux_bounds</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">reactions</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">species</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">compartments</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">genes</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__genes_idx__</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__single_gene_effect_map__</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">gpr</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_parameters_</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">N</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">sourcefile</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">user_constraints</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">CM</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">sensitivity</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="c">##  optValue = None</span>
    <span class="c">##  optType = None</span>
    <span class="n">SCALED_REDUCED_COSTS</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">SOLUTION_STATUS_INT</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">SOLUTION_STATUS</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">DATE_CREATED</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">DATE_MODIFIED</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">MODEL_CREATORS</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__gene_deactivated_reactions__</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_SBML_LEVEL_</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__FBC_VERSION__</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">__FBC_STRICT__</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="c">#__objref__ = None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Container for constraint based model.</span>

<span class="sd">         - *pid* a string with the model ID</span>

<span class="sd">        Adds methods for manipulating:</span>

<span class="sd">         - objectives</span>
<span class="sd">         - constraints</span>
<span class="sd">         - reactions</span>
<span class="sd">         - species</span>
<span class="sd">         - compartments</span>
<span class="sd">         - groups</span>
<span class="sd">         - N a structmatrix object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPid</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__genes_idx__</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MODEL_CREATORS</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__gene_deactivated_reactions__</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartment</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__delattr__</span><span class="p">(</span><span class="s">&#39;compartment&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Model.clone"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.clone">[docs]</a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a clone of this object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tzero</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">cpy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">cpy</span><span class="o">.</span><span class="n">__setModelSelf__</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Model clone time: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tzero</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">cpy</span>
</div>
    <span class="k">def</span> <span class="nf">__setModelSelf__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method sets the model reference (updates the weakref) to the current instance. This is a</span>
<span class="sd">        utility function that mostly comes into play when a model is cloned or objects are mixed between models</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">r</span><span class="o">.</span><span class="n">__setObjRef__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">__setObjRef__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">fb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">:</span>
            <span class="n">fb</span><span class="o">.</span><span class="n">__setObjRef__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">:</span>
            <span class="n">o</span><span class="o">.</span><span class="n">__setObjRef__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">__setObjRef__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">__setObjRef__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__unsetModelSelf__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method unsets the model reference (deletes the weakref). This is a</span>
<span class="sd">        utility function that mostly comes into play when a model is cloned or objects are mixed between models</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">r</span><span class="o">.</span><span class="n">__unsetObjRef__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">__unsetObjRef__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">fb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">:</span>
            <span class="n">fb</span><span class="o">.</span><span class="n">__unsetObjRef__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">:</span>
            <span class="n">o</span><span class="o">.</span><span class="n">__unsetObjRef__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">__unsetObjRef__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">__unsetObjRef__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dic</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal method that allows our weakrefs to be &#39;picklable&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="n">dic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__setModelSelf__</span><span class="p">()</span>

<div class="viewcode-block" id="Model.addMIRIAMannotation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addMIRIAMannotation">[docs]</a>    <span class="k">def</span> <span class="nf">addMIRIAMannotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qual</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">mid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a qualified MIRIAM annotation or entity:</span>

<span class="sd">         - *qual* a Biomodels biological qualifier e.g. &quot;is&quot; &quot;isEncodedBy&quot;</span>
<span class="sd">         - *entity* a MIRIAM resource entity e.g. &quot;ChEBI&quot;</span>
<span class="sd">         - *mid* the entity id e.g. CHEBI:17158</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span> <span class="o">=</span> <span class="n">MIRIAMannotation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">miriam</span><span class="o">.</span><span class="n">addMIRIAMannotation</span><span class="p">(</span><span class="n">qual</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.setDescription"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setDescription">[docs]</a>    <span class="k">def</span> <span class="nf">setDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the model description which translates into the SBML &lt;notes&gt; field.</span>

<span class="sd">         - *html* any valid html or the empty string to clear &#39;&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">html</span>
</div>
<div class="viewcode-block" id="Model.getDescription"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the model description which was stored in the SBML &lt;notes&gt; field</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span>
</div>
<div class="viewcode-block" id="Model.setCreatedDate"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setCreatedDate">[docs]</a>    <span class="k">def</span> <span class="nf">setCreatedDate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the model created date tuple(year, month, day, hour, minute, second)</span>

<span class="sd">        - *date* [default=None] default is now (automatic) otherwise (year, month, day, hour, minute, second) e.g. (2012, 09, 24, 13, 34, 00)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">date</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">lt</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATE_CREATED</span> <span class="o">=</span> <span class="p">(</span><span class="n">lt</span><span class="o">.</span><span class="n">tm_year</span><span class="p">,</span> <span class="n">lt</span><span class="o">.</span><span class="n">tm_mon</span><span class="p">,</span> <span class="n">lt</span><span class="o">.</span><span class="n">tm_mday</span><span class="p">,</span> <span class="n">lt</span><span class="o">.</span><span class="n">tm_hour</span><span class="p">,</span> <span class="n">lt</span><span class="o">.</span><span class="n">tm_min</span><span class="p">,</span> <span class="n">lt</span><span class="o">.</span><span class="n">tm_sec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Invalid date&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATE_CREATED</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">date</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATE_MODIFIED</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setModifiedDate</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Model.setModifiedDate"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setModifiedDate">[docs]</a>    <span class="k">def</span> <span class="nf">setModifiedDate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the model modification date: tuple(year, month, day, hour, minute, second)</span>

<span class="sd">        - *date* [default=None] default is now (automatic) otherwise (year, month, day, hour, minute, second) e.g. (2012, 09, 24, 13, 34, 00)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">date</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">lt</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATE_MODIFIED</span> <span class="o">=</span> <span class="p">(</span><span class="n">lt</span><span class="o">.</span><span class="n">tm_year</span><span class="p">,</span> <span class="n">lt</span><span class="o">.</span><span class="n">tm_mon</span><span class="p">,</span> <span class="n">lt</span><span class="o">.</span><span class="n">tm_mday</span><span class="p">,</span> <span class="n">lt</span><span class="o">.</span><span class="n">tm_hour</span><span class="p">,</span> <span class="n">lt</span><span class="o">.</span><span class="n">tm_min</span><span class="p">,</span> <span class="n">lt</span><span class="o">.</span><span class="n">tm_sec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Invalid date&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATE_MODIFIED</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">date</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATE_CREATED</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setCreatedDate</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="Model.addModelCreator"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addModelCreator">[docs]</a>    <span class="k">def</span> <span class="nf">addModelCreator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">firstname</span><span class="p">,</span> <span class="n">lastname</span><span class="p">,</span> <span class="n">organisation</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a model creator to the list of model creators, only the first and fmaily names are mandatory:</span>

<span class="sd">         - *firstname*</span>
<span class="sd">         - *lastname*</span>
<span class="sd">         - *organisation* [default=None]</span>
<span class="sd">         - *email*  [default=None]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MODEL_CREATORS</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">firstname</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">+</span><span class="n">lastname</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s">&#39;firstname&#39;</span> <span class="p">:</span> <span class="n">firstname</span><span class="p">,</span>
            <span class="s">&#39;lastname&#39;</span> <span class="p">:</span> <span class="n">lastname</span><span class="p">,</span>
            <span class="s">&#39;organisation&#39;</span> <span class="p">:</span> <span class="n">organisation</span><span class="p">,</span>
            <span class="s">&#39;email&#39;</span> <span class="p">:</span> <span class="n">email</span>
        <span class="p">}</span>
                                    <span class="p">})</span>
</div>
<div class="viewcode-block" id="Model.getModelCreators"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getModelCreators">[docs]</a>    <span class="k">def</span> <span class="nf">getModelCreators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return model creator information</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MODEL_CREATORS</span>
        <span class="k">for</span> <span class="n">c_</span> <span class="ow">in</span> <span class="n">mc</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">mc</span><span class="p">[</span><span class="n">c_</span><span class="p">][</span><span class="s">&#39;firstname&#39;</span><span class="p">],</span> <span class="n">mc</span><span class="p">[</span><span class="n">c_</span><span class="p">][</span><span class="s">&#39;lastname&#39;</span><span class="p">],</span> <span class="n">mc</span><span class="p">[</span><span class="n">c_</span><span class="p">][</span><span class="s">&#39;organisation&#39;</span><span class="p">],</span> <span class="n">mc</span><span class="p">[</span><span class="n">c_</span><span class="p">][</span><span class="s">&#39;email&#39;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.addObjective"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addObjective">[docs]</a>    <span class="k">def</span> <span class="nf">addObjective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an instantiated Objective object to the FBA model</span>

<span class="sd">        - *obj* an instance of the Objective class</span>
<span class="sd">        - *active* [default=False] flag this objective as the active objective (fba.activeObjIdx)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="n">Objective</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">ERROR: requires an Objective object, not something of type {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Adding objective: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">active</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">activeObjIdx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
</div>
<div class="viewcode-block" id="Model.createObjectiveFunction"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createObjectiveFunction">[docs]</a>    <span class="k">def</span> <span class="nf">createObjectiveFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">coefficient</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">osense</span><span class="o">=</span><span class="s">&#39;maximize&#39;</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">delete_current_obj</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a single variable objective function:</span>

<span class="sd">         - **rid** The</span>
<span class="sd">         - **coefficient** [default=1]</span>
<span class="sd">         - **osense** [default=&#39;maximize&#39;]</span>
<span class="sd">         - **active** [default=True]</span>
<span class="sd">         - **delete_current_obj** [default=True]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_obj_id</span> <span class="o">=</span> <span class="n">rid</span> <span class="o">+</span> <span class="s">&#39;_objective&#39;</span>
        <span class="k">assert</span> <span class="n">new_obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObjectiveIds</span><span class="p">(),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Objective Id </span><span class="si">%s</span><span class="s"> already exists&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">new_obj_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">delete_current_obj</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObjectiveIds</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deleteObjective</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">new_obj_id</span><span class="p">,</span> <span class="n">osense</span><span class="p">)</span>
        <span class="n">FO</span> <span class="o">=</span> <span class="n">FluxObjective</span><span class="p">(</span><span class="s">&#39;{}_{}_fluxobj&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_obj_id</span><span class="p">,</span> <span class="n">rid</span><span class="p">),</span> <span class="n">rid</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addFluxObjective</span><span class="p">(</span><span class="n">FO</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addObjective</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="n">active</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.createSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">createSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sid</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">),</span> <span class="n">compartment</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">chemFormula</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new species and add it to the model:</span>

<span class="sd">         - **id** the unique species id</span>
<span class="sd">         - **boundary** [default=False] whether the species is a variable (False) or is a boundary parameter (fixed)</span>
<span class="sd">         - **name** [default=&#39;&#39;] the species name</span>
<span class="sd">         - **value** [default=nan] the value *not currently used*</span>
<span class="sd">         - **compartment** [default=None] the compartment the species is located in</span>
<span class="sd">         - **charge** [default=None] the species charge</span>
<span class="sd">         - **chemFormula** [default=None] the chemical formula</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="n">sid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">(),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Species id</span><span class="se">\&#39;</span><span class="s">s must be unique: {} exists&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>

        <span class="n">S</span> <span class="o">=</span> <span class="n">Species</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="n">boundary</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">compartment</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span> <span class="n">chemFormula</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addSpecies</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Model.createCompartment"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createCompartment">[docs]</a>    <span class="k">def</span> <span class="nf">createCompartment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new compartment and add it to the model if the id does not exist</span>

<span class="sd">        - *cid* compartment id</span>
<span class="sd">        - *name* [None] compartment name</span>
<span class="sd">        - *size* [1] compartment size</span>
<span class="sd">        - *dimensions* [3] compartment size dimensions</span>
<span class="sd">        - *volume* [None] compartment volume</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCompartmentIds</span><span class="p">():</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">Compartment</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addCompartment</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Error: compartment id </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cid</span><span class="p">))</span>


</div>
<div class="viewcode-block" id="Model.createReaction"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createReaction">[docs]</a>    <span class="k">def</span> <span class="nf">createReaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">reversible</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">create_default_bounds</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new blank reaction and add it to the model:</span>

<span class="sd">         - **id** the unique reaction ID</span>
<span class="sd">         - **name** the reaction name</span>
<span class="sd">         - **reversible** [default=True] the reaction reversibility. True is reversible, False is irreversible</span>
<span class="sd">         - **create_default_bounds** create default reaction bounds, irreversible 0 &lt;= J &lt;= INF, reversable -INF &lt;= J &lt;= INF</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="n">rid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">(),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Reaction ID </span><span class="si">%s</span><span class="s"> already exists&#39;</span> <span class="o">%</span> <span class="n">rid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addReaction</span><span class="p">(</span><span class="n">Reaction</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">reversible</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">create_default_bounds</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">createReactionUpperBound</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">reversible</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">createReactionLowerBound</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Reaction bounds set to: -INF &lt;= {} &lt;= INF&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rid</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">createReactionLowerBound</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Reaction bounds set to: 0 &lt;= {} &lt;= INF&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rid</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Add reagents with cmod.createReactionReagent({}, metabolite, coefficient)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rid</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.createReactionReagent"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createReactionReagent">[docs]</a>    <span class="k">def</span> <span class="nf">createReactionReagent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="n">metabolite</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a reagent to an existing reaction, both reaction and metabolites must exist</span>

<span class="sd">         - *reaction* a reaction id</span>
<span class="sd">         - *metabolite* a species/metabolite id</span>
<span class="sd">         - *coefficient* the reagent coefficient</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">metabolite</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">R</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Reaction {} does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">S</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Metabolite {} does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metabolite</span><span class="p">)</span>
        <span class="n">R</span><span class="o">.</span><span class="n">createReagent</span><span class="p">(</span><span class="n">metabolite</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">)</span>
        <span class="n">S</span><span class="o">.</span><span class="n">setReagentOf</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Added </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> as a reagent of reaction </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metabolite</span><span class="p">,</span> <span class="n">reaction</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.createReactionLowerBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createReactionLowerBound">[docs]</a>    <span class="k">def</span> <span class="nf">createReactionLowerBound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new lower bound for a reaction: value &lt;= reaction</span>

<span class="sd">         - **reaction** the reaction id</span>
<span class="sd">         - **value** the value of the bound</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">bnds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionBounds</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">bnds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">bnds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Lower or equality bound exists for reaction: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">reaction</span>
        <span class="n">newId</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">_bnd&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="s">&#39;lower&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addFluxBound</span><span class="p">(</span><span class="n">FluxBound</span><span class="p">(</span><span class="n">newId</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="s">&#39;greaterEqual&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="Model.createReactionUpperBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createReactionUpperBound">[docs]</a>    <span class="k">def</span> <span class="nf">createReactionUpperBound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new upper bound for a reaction: reaction &lt;= value</span>

<span class="sd">         - **reaction** the reaction id</span>
<span class="sd">         - **value** the value of the bound</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">bnds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionBounds</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">bnds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">bnds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Upper or equality bound exists for reaction: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">reaction</span>
        <span class="n">newId</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">_bnd&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="s">&#39;upper&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addFluxBound</span><span class="p">(</span><span class="n">FluxBound</span><span class="p">(</span><span class="n">newId</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="s">&#39;lessEqual&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.createReactionBounds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createReactionBounds">[docs]</a>    <span class="k">def</span> <span class="nf">createReactionBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="n">lb_value</span><span class="p">,</span> <span class="n">ub_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new lower bound for a reaction: value &lt;= reaction</span>

<span class="sd">         - **reaction** the reaction id</span>
<span class="sd">         - **lb_value** the value of the lower bound</span>
<span class="sd">         - **ub_value** the value of the upper bound</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bnds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionBounds</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">bnds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Lower bound exists for reaction: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">reaction</span>
        <span class="k">assert</span> <span class="n">bnds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Upper bound exists for reaction: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">reaction</span>
        <span class="k">assert</span> <span class="n">bnds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Equality bound exists for reaction: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">reaction</span>
        <span class="k">assert</span> <span class="n">lb_value</span> <span class="o">&lt;=</span> <span class="n">ub_value</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Lower bound must be less than or equal to upper bound.&#39;</span>
        <span class="n">newId</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">_bnd&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="s">&#39;lower&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addFluxBound</span><span class="p">(</span><span class="n">FluxBound</span><span class="p">(</span><span class="n">newId</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="s">&#39;greaterEqual&#39;</span><span class="p">,</span> <span class="n">lb_value</span><span class="p">))</span>
        <span class="n">newId</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">_bnd&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="s">&#39;upper&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addFluxBound</span><span class="p">(</span><span class="n">FluxBound</span><span class="p">(</span><span class="n">newId</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="s">&#39;lessEqual&#39;</span><span class="p">,</span> <span class="n">ub_value</span><span class="p">))</span>


</div>
<div class="viewcode-block" id="Model.addFluxBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addFluxBound">[docs]</a>    <span class="k">def</span> <span class="nf">addFluxBound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fluxbound</span><span class="p">,</span> <span class="n">fbexists</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an instantiated FluxBound object to the FBA model</span>

<span class="sd">        - *fluxbound* an instance of the FluxBound class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">fluxbound</span><span class="p">)</span> <span class="o">==</span> <span class="n">FluxBound</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">ERROR: requires a FluxBound object, not something of type {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">fluxbound</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">fbexists</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">RL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByReactionID</span><span class="p">(</span><span class="n">fluxbound</span><span class="o">.</span><span class="n">getReactionId</span><span class="p">(),</span> <span class="s">&#39;lower&#39;</span><span class="p">)</span>
            <span class="n">RU</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByReactionID</span><span class="p">(</span><span class="n">fluxbound</span><span class="o">.</span><span class="n">getReactionId</span><span class="p">(),</span> <span class="s">&#39;upper&#39;</span><span class="p">)</span>
            <span class="n">GO</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="n">RL</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">RL</span><span class="o">.</span><span class="n">is_bound</span> <span class="o">==</span> <span class="n">fluxbound</span><span class="o">.</span><span class="n">is_bound</span> <span class="ow">and</span> <span class="n">RL</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="n">fluxbound</span><span class="o">.</span><span class="n">reaction</span><span class="p">:</span>
                <span class="c">#print(&#39;Lower bound on reaction {} already exists&#39;.format(fluxbound.getReactionId()))</span>
                <span class="n">GO</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">RU</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">RU</span><span class="o">.</span><span class="n">is_bound</span> <span class="o">==</span> <span class="n">fluxbound</span><span class="o">.</span><span class="n">is_bound</span> <span class="ow">and</span> <span class="n">RU</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="n">fluxbound</span><span class="o">.</span><span class="n">reaction</span><span class="p">:</span>
                <span class="c">#print(&#39;Upper bound on reaction {} already exists&#39;.format(fluxbound.getReactionId()))</span>
                <span class="n">GO</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&#39;Adding fluxbound: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fluxbound</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">GO</span><span class="p">:</span>
                <span class="n">fluxbound</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fluxbound</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> FluxBound for reaction {} exists, skipping&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fluxbound</span><span class="o">.</span><span class="n">is_bound</span><span class="p">,</span> <span class="n">fluxbound</span><span class="o">.</span><span class="n">reaction</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">fluxbound</span><span class="o">.</span><span class="n">getReactionId</span><span class="p">(),</span> <span class="n">fluxbound</span><span class="o">.</span><span class="n">getType</span><span class="p">())</span> <span class="ow">in</span> <span class="n">fbexists</span><span class="p">:</span>
                <span class="n">fluxbound</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fluxbound</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> FluxBound for reaction {} exists, skipping&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fluxbound</span><span class="o">.</span><span class="n">is_bound</span><span class="p">,</span> <span class="n">fluxbound</span><span class="o">.</span><span class="n">reaction</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.addSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">addSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an instantiated Species object to the FBA model</span>

<span class="sd">        - *species* an instance of the Species class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">Species</span><span class="p">),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">ERROR: requires a Species object, not something of type {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">species</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&#39;Adding species: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">species</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
        <span class="n">species</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.addGene"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addGene">[docs]</a>    <span class="k">def</span> <span class="nf">addGene</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gene</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an instantiated Gene object to the FBA model</span>

<span class="sd">        - *gene* an instance of the G class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gene</span><span class="p">,</span> <span class="n">Gene</span><span class="p">),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">ERROR: requires a Species object, not something of type {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">gene</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&#39;Adding Gene: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gene</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
        <span class="n">gene</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gene</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.addParameter"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addParameter">[docs]</a>    <span class="k">def</span> <span class="nf">addParameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">par</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an instantiated Parameter object to the model</span>

<span class="sd">        - *par* an instance of the Parameter class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">ERROR: requires a Parameter object, not something of type {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">par</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&#39;Adding Parameter: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
        <span class="c">#comp.__objref__ = weakref.ref(self)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.addCompartment"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addCompartment">[docs]</a>    <span class="k">def</span> <span class="nf">addCompartment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an instantiated Compartment object to the CBM model</span>

<span class="sd">        - *comp* an instance of the Compartment class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="n">Compartment</span><span class="p">),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">ERROR: requires a Compartment object, not something of type {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">comp</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&#39;Adding Compartment: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
        <span class="n">comp</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.addReaction"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addReaction">[docs]</a>    <span class="k">def</span> <span class="nf">addReaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a reaction object to the model</span>

<span class="sd">        - *reaction* an instance of the Reaction class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">ERROR: requires a Reaction object, not something of type {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">reaction</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&#39;Adding reaction: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>

        <span class="n">reaction</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.addUserConstraint"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addUserConstraint">[docs]</a>    <span class="k">def</span> <span class="nf">addUserConstraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">fluxes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a user defined constraint to FBA model, this is additional to the automatically determined Stoichiometric constraints.</span>

<span class="sd">         - *pid* user constraint name/id, use `None` for auto-assign</span>
<span class="sd">         - *fluxes* a list of (coefficient, reaction id) pairs where coefficient is a float</span>
<span class="sd">         - *operator* is one of = &gt; &lt; &gt;= &lt;=</span>
<span class="sd">         - *rhs* a float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">fluxes</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">No *fluxes* defined: a list of (coefficient, reaction id) pairs where coefficient is a float&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_constraints</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_constraints</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Rids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">()</span>
        <span class="n">fluxlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">fluxes</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">Rids</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="si">%s</span><span class="s"> is not a valid reaction id&#39;</span> <span class="o">%</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fluxlist</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Fluxes may only appear once per constraint:</span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">fluxes</span>
            <span class="n">fluxlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">operator</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">,</span> <span class="s">&#39;G&#39;</span><span class="p">,</span> <span class="s">&#39;E&#39;</span><span class="p">],</span> <span class="s">&#39;</span><span class="se">\n</span><span class="si">%s</span><span class="s"> is not a valid operator&#39;</span> <span class="o">%</span> <span class="n">operator</span>
        <span class="k">if</span> <span class="n">operator</span> <span class="o">==</span> <span class="s">&#39;=&#39;</span> <span class="ow">or</span> <span class="n">operator</span> <span class="o">==</span> <span class="s">&#39;E&#39;</span><span class="p">:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="s">&#39;E&#39;</span>
        <span class="k">elif</span> <span class="n">operator</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="s">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;G&#39;</span><span class="p">]:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="s">&#39;G&#39;</span>
        <span class="k">elif</span> <span class="n">operator</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s">&#39;=&lt;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">]:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="s">&#39;L&#39;</span>

        <span class="n">rhs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pid</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="s">&#39;uConstr</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_constraints</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_constraints</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">pid</span> <span class="p">:</span> <span class="p">{</span><span class="s">&#39;fluxes&#39;</span> <span class="p">:</span> <span class="n">fluxes</span><span class="p">,</span>
                                              <span class="s">&#39;operator&#39;</span> <span class="p">:</span> <span class="n">operator</span><span class="p">,</span>
                                              <span class="s">&#39;rhs&#39;</span> <span class="p">:</span> <span class="n">rhs</span><span class="p">}</span>
                                      <span class="p">})</span>

</div>
<div class="viewcode-block" id="Model.deleteReactionAndBounds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.deleteReactionAndBounds">[docs]</a>    <span class="k">def</span> <span class="nf">deleteReactionAndBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete all reaction and bounds connected to reaction</span>

<span class="sd">         - *rid* a valid reaction id</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Ridx</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">Robj</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">assert</span> <span class="n">rid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">(),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Oh Hellooooooooooooo&#39;</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="o">==</span> <span class="n">rid</span><span class="p">:</span>
                <span class="n">Ridx</span> <span class="o">=</span> <span class="n">rid</span>
                <span class="n">Robj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">Bounds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="n">rid</span><span class="p">:</span>
                <span class="n">Bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Deleting reaction {} and {} associated bounds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Ridx</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Bounds</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">s_</span> <span class="ow">in</span> <span class="n">Robj</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">():</span>
            <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">s_</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Ridx</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">reagent_of</span><span class="p">:</span>
                <span class="n">S</span><span class="o">.</span><span class="n">reagent_of</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">Ridx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">Ridx</span> <span class="p">:</span> <span class="p">{</span><span class="s">&#39;react&#39;</span> <span class="p">:</span> <span class="n">Robj</span><span class="p">,</span> <span class="s">&#39;bnds&#39;</span> <span class="p">:</span> <span class="n">Bounds</span><span class="p">}})</span>
</div>
<div class="viewcode-block" id="Model.deleteObjective"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.deleteObjective">[docs]</a>    <span class="k">def</span> <span class="nf">deleteObjective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objective_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete objective function:</span>

<span class="sd">         *objective_id* the id of the objective function. If objective_id is given  as &#39;active&#39; then the active objective is deleted.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">objective_id</span> <span class="o">==</span> <span class="s">&#39;active&#39;</span><span class="p">:</span>
            <span class="n">objective_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getActiveObjective</span><span class="p">()</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span>

        <span class="k">assert</span> <span class="n">objective_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObjectiveIds</span><span class="p">(),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">No ....&#39;</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="o">==</span> <span class="n">objective_id</span><span class="p">:</span>
                <span class="n">Oidx</span> <span class="o">=</span> <span class="n">objective_id</span>
                <span class="n">Oobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Deleting objective {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Oidx</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">Oidx</span> <span class="p">:</span> <span class="n">Oobj</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="Model.undeleteObjective"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.undeleteObjective">[docs]</a>    <span class="k">def</span> <span class="nf">undeleteObjective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objective_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Undeltes a deleted objective function:</span>

<span class="sd">         - *objective_id* the id of an objeective function</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="n">objective_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">No deleted object of with this id&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addObjective</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="p">[</span><span class="n">objective_id</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="Model.deleteBoundsForReactionId"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.deleteBoundsForReactionId">[docs]</a>    <span class="k">def</span> <span class="nf">deleteBoundsForReactionId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete bounds connected to reaction, rid</span>

<span class="sd">         - *rid* a valid reaction id</span>
<span class="sd">         - *upper* [default=True] delete the upper bound</span>
<span class="sd">         - *lower* [default=True] delete the lower bound</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">##  Ridx = None</span>
        <span class="c">##  Robj = None</span>
        <span class="n">Bounds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="n">rid</span><span class="p">:</span>
                <span class="n">delbound</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">if</span> <span class="n">upper</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;upper&#39;</span><span class="p">:</span>
                    <span class="n">delbound</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">if</span> <span class="n">lower</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;lower&#39;</span><span class="p">:</span>
                    <span class="n">delbound</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">if</span> <span class="n">lower</span> <span class="ow">and</span> <span class="n">upper</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;equality&#39;</span><span class="p">:</span>
                    <span class="n">delbound</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">if</span> <span class="n">delbound</span><span class="p">:</span>
                    <span class="n">Bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Deleting {} bounds associated with reaction {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Bounds</span><span class="p">),</span> <span class="n">rid</span><span class="p">))</span>
        <span class="k">del</span> <span class="n">Bounds</span>
</div>
<div class="viewcode-block" id="Model.undeleteReactionAndBounds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.undeleteReactionAndBounds">[docs]</a>    <span class="k">def</span> <span class="nf">undeleteReactionAndBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Undelete a reaction and bounds deleted with the **deleteReactionAndBounds** method</span>

<span class="sd">         - *rid* a deleted reaction id</span>

<span class="sd">        Please note this method is still experimental ;-)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">rid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Oops I did it again ...&#39;</span>
        <span class="n">Ridx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="p">[</span><span class="n">rid</span><span class="p">][</span><span class="s">&#39;react&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addReaction</span><span class="p">(</span><span class="n">Ridx</span><span class="p">)</span>
        <span class="c"># this is just while transitioning to new dynamic structures</span>
        <span class="k">for</span> <span class="n">s_</span> <span class="ow">in</span> <span class="n">Ridx</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">s_</span><span class="p">)</span><span class="o">.</span><span class="n">setReagentOf</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="p">[</span><span class="n">rid</span><span class="p">][</span><span class="s">&#39;bnds&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addFluxBound</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Undeleting reaction: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rid</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.createGeneAssociationsFromAnnotations"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createGeneAssociationsFromAnnotations">[docs]</a>    <span class="k">def</span> <span class="nf">createGeneAssociationsFromAnnotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">annotation_key</span><span class="o">=</span><span class="s">&#39;GENE ASSOCIATION&#39;</span><span class="p">,</span> <span class="n">replace_existing</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add genes to the model using the definitions stored in the annotation key. If this fails it tries some standard annotation</span>
<span class="sd">        keys: GENE ASSOCIATION, GENE_ASSOCIATION, gene_association, gene association.</span>

<span class="sd">         - *annotation_key* the annotation dictionary key that holds the gene association for the protein/enzyme</span>
<span class="sd">         - *replace_existing* [default=True] replace existing annotations, otherwise only new ones are added</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># protein, assoc, id=None, name=None, gene_pattern=&#39;(\(\W*\w*\W*\))&#39;)</span>
        <span class="k">if</span> <span class="n">replace_existing</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">genes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__genes_idx__</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">gid</span> <span class="o">=</span> <span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">g0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">)</span>
        <span class="n">gpr0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">)</span>
        <span class="n">ga_keys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">():</span>
            <span class="n">GA</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="n">r_</span><span class="p">)</span>
            <span class="c">##  print r.annotation</span>
            <span class="k">if</span> <span class="n">annotation_key</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="n">GA</span> <span class="o">=</span> <span class="n">annotation_key</span>
            <span class="k">elif</span> <span class="s">&#39;GENE ASSOCIATION&#39;</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="n">GA</span> <span class="o">=</span> <span class="s">&#39;GENE ASSOCIATION&#39;</span>
            <span class="k">elif</span> <span class="s">&#39;GENE_ASSOCIATION&#39;</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="n">GA</span> <span class="o">=</span> <span class="s">&#39;GENE_ASSOCIATION&#39;</span>
            <span class="k">elif</span> <span class="s">&#39;gene_association&#39;</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="n">GA</span> <span class="o">=</span> <span class="s">&#39;gene_association&#39;</span>
            <span class="k">elif</span> <span class="s">&#39;gene association&#39;</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="n">GA</span> <span class="o">=</span> <span class="s">&#39;gene association&#39;</span>
            <span class="k">if</span> <span class="n">GA</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">createGeneProteinAssociation</span><span class="p">(</span><span class="n">r_</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">getAnnotation</span><span class="p">(</span><span class="n">GA</span><span class="p">),</span> <span class="n">gid</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">update_idx</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">GA</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ga_keys</span><span class="p">:</span>
                    <span class="n">ga_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GA</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&#39;INFO: used key(s) </span><span class="se">\&#39;</span><span class="s">{}</span><span class="se">\&#39;</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ga_keys</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__updateGeneIdx__</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;INFO: Added {} new genes and {} associations to model&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">)</span><span class="o">-</span> <span class="n">g0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">)</span><span class="o">-</span> <span class="n">gpr0</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="Model.addGPRAssociation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addGPRAssociation">[docs]</a>    <span class="k">def</span> <span class="nf">addGPRAssociation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpr</span><span class="p">,</span> <span class="n">update_idx</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a GeneProteinAssociation instance to the model</span>

<span class="sd">         - *gpr* an instantiated GeneProteinAssociation object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">update_idx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__updateGeneIdx__</span><span class="p">()</span>

        <span class="n">gpr</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gpr</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.createGeneProteinAssociation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createGeneProteinAssociation">[docs]</a>    <span class="k">def</span> <span class="nf">createGeneProteinAssociation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protein</span><span class="p">,</span> <span class="n">assoc</span><span class="p">,</span> <span class="n">gid</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">gene_pattern</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">update_idx</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">altlabels</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and add a gene protein relationship to the model, note genes are mapped on protein objects which may or may not be reactions</span>

<span class="sd">         - *protein* in this case the reaction</span>
<span class="sd">         - *assoc* the COBRA style gene protein association</span>
<span class="sd">         - *gid* the unique id</span>
<span class="sd">         - *name* the optional name</span>
<span class="sd">         - *gene_pattern* deprecated, not needed anymore</span>
<span class="sd">         - *update_idx* update the model gene index, not used</span>
<span class="sd">         - *altlabels* [default=None] alternative labels for genes, default uses geneIds</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">altlabels</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">altlabels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">assoc</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span> <span class="ow">and</span> <span class="n">assoc</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gid</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">gid</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">_assoc&#39;</span> <span class="o">%</span> <span class="n">protein</span>
            <span class="n">gpr</span> <span class="o">=</span> <span class="n">GeneProteinAssociation</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">protein</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addGPRAssociation</span><span class="p">(</span><span class="n">gpr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">gid</span>
            <span class="n">gpr</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">gpr</span><span class="o">.</span><span class="n">createAssociationAndGeneRefs</span><span class="p">(</span><span class="n">assoc</span><span class="p">,</span> <span class="n">altlabels</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__updateGeneIdx__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the gene name index</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__genes_idx__</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">]</span>

<div class="viewcode-block" id="Model.getAllProteinGeneAssociations"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getAllProteinGeneAssociations">[docs]</a>    <span class="k">def</span> <span class="nf">getAllProteinGeneAssociations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of the proteins associated with each gene</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">gpr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gpr</span><span class="o">.</span><span class="n">getGenes</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">prg</span><span class="p">:</span>
                    <span class="n">prg</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">g</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="p">:</span> <span class="p">[</span><span class="n">gpr</span><span class="o">.</span><span class="n">protein</span><span class="p">]})</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prg</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">getPid</span><span class="p">()]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gpr</span><span class="o">.</span><span class="n">protein</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prg</span>
</div>
<div class="viewcode-block" id="Model.getAllGeneProteinAssociations"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getAllGeneProteinAssociations">[docs]</a>    <span class="k">def</span> <span class="nf">getAllGeneProteinAssociations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of genes associated with each protein</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gprmap</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">gpr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gpr</span><span class="o">.</span><span class="n">protein</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gprmap</span><span class="p">:</span>
                <span class="n">gprmap</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">gpr</span><span class="o">.</span><span class="n">protein</span> <span class="p">:</span> <span class="n">gpr</span><span class="o">.</span><span class="n">getGeneIds</span><span class="p">()})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gprmap</span><span class="p">[</span><span class="n">gpr</span><span class="o">.</span><span class="n">protein</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">gpr</span><span class="o">.</span><span class="n">getGeneIds</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">gprmap</span>
</div>
<div class="viewcode-block" id="Model.getGene"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getGene">[docs]</a>    <span class="k">def</span> <span class="nf">getGene</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a gene object that has the identifier:</span>

<span class="sd">         - *gid* the gene identifier</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">g_</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="o">==</span> <span class="n">g_id</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">g_</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.getGPRassociation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getGPRassociation">[docs]</a>    <span class="k">def</span> <span class="nf">getGPRassociation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpr_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a gene protein association object that has the identifier:</span>

<span class="sd">         - *gpr_id* the gene protein identifier</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">g_</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="o">==</span> <span class="n">gpr_id</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">g_</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.getGPRforReaction"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getGPRforReaction">[docs]</a>    <span class="k">def</span> <span class="nf">getGPRforReaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the GPR associated with the reaction id:</span>

<span class="sd">         - *rid* a reaction id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="si">%E</span><span class="s">RROR: </span><span class="si">%s</span><span class="s"> is not a valid reaction id&#39;</span> <span class="o">%</span> <span class="n">rid</span>
        <span class="k">for</span> <span class="n">gpr_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gpr_</span><span class="o">.</span><span class="n">getProtein</span><span class="p">()</span> <span class="o">==</span> <span class="n">rid</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">gpr_</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.getReactionActivity"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getReactionActivity">[docs]</a>    <span class="k">def</span> <span class="nf">getReactionActivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If there is a GPR and genes associated with the reaction ID then return either active=True or inactive=False</span>
<span class="sd">        Note if there is no gene associated information then this will return active.</span>

<span class="sd">         - *rid* a reaction id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">GPR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGPRforReaction</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">GPR</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">GPR</span><span class="o">.</span><span class="n">isProteinActive</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.getGeneIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getGeneIds">[docs]</a>    <span class="k">def</span> <span class="nf">getGeneIds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of gene Ids, applies a substring search if substring is defined</span>

<span class="sd">         - *substring* search for this pattern anywhere in the id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">substring</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span> <span class="k">if</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">getPid</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="Model.getAllGeneActivities"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getAllGeneActivities">[docs]</a>    <span class="k">def</span> <span class="nf">getAllGeneActivities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of genes (if defined) and whether they are active or not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="n">g_</span><span class="o">.</span><span class="n">getPid</span><span class="p">()]</span> <span class="o">=</span> <span class="n">g_</span><span class="o">.</span><span class="n">isActive</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.getAllProteinActivities"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getAllProteinActivities">[docs]</a>    <span class="k">def</span> <span class="nf">getAllProteinActivities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of reactions (if genes and GPR&#39;s are defined) and whether they are active or not</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="n">g_</span><span class="o">.</span><span class="n">getProtein</span><span class="p">()]</span> <span class="o">=</span> <span class="n">g_</span><span class="o">.</span><span class="n">isProteinActive</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.setAllProteinActivities"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setAllProteinActivities">[docs]</a>    <span class="k">def</span> <span class="nf">setAllProteinActivities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">activites</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a dictionary of activities [rid : boolean] pairs set all the corresponding reactions:</span>

<span class="sd">         - *activities* a dictionary of [rid : boolean] pairs</span>
<span class="sd">         - *lower* [default=0.0] the lower bound of the deactivated flux</span>
<span class="sd">         - *upper* [default=0.0] the upper bound of the deactivated flux</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">r_</span> <span class="ow">in</span> <span class="n">activites</span><span class="p">:</span>
            <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="n">r_</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">activites</span><span class="p">[</span><span class="n">r_</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">R</span><span class="o">.</span><span class="n">__is_active__</span><span class="p">:</span>
                <span class="n">R</span><span class="o">.</span><span class="n">reactivateReaction</span><span class="p">()</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">activites</span><span class="p">[</span><span class="n">r_</span><span class="p">]</span> <span class="ow">and</span> <span class="n">R</span><span class="o">.</span><span class="n">__is_active__</span><span class="p">:</span>
                <span class="n">R</span><span class="o">.</span><span class="n">deactivateReaction</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.setAllInactiveGPRBounds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setAllInactiveGPRBounds">[docs]</a>    <span class="k">def</span> <span class="nf">setAllInactiveGPRBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set all reactions that are inactive (as determined by gene and gpr evaluation) to bounds:</span>

<span class="sd">         - *lower* [default=0.0] the new lower bound</span>
<span class="sd">         - *upper* [default=0.0] the new upper bound</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gpract</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAllProteinActivities</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">r_</span> <span class="ow">in</span> <span class="n">gpract</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">gpract</span><span class="p">[</span><span class="n">r_</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__gene_deactivated_reactions__</span><span class="p">[</span><span class="n">r_</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionBounds</span><span class="p">(</span><span class="n">r_</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setReactionBounds</span><span class="p">(</span><span class="n">r_</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;Setting reaction {} bounds to [{}, {}]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.resetAllInactiveGPRBounds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.resetAllInactiveGPRBounds">[docs]</a>    <span class="k">def</span> <span class="nf">resetAllInactiveGPRBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets all reaction bounds modified by the ``cmod.setAllInactiveGeneReactionBounds()`` method to their previous values</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">r_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gene_deactivated_reactions__</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gene_deactivated_reactions__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">r_</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setReactionBounds</span><span class="p">(</span><span class="n">r_</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Resetting reaction {} bounds to [{}, {}]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</div>
<div class="viewcode-block" id="Model.changeAllFluxBoundsWithValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.changeAllFluxBoundsWithValue">[docs]</a>    <span class="k">def</span> <span class="nf">changeAllFluxBoundsWithValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replaces all flux bounds with value &quot;old&quot; with a new value &quot;new&quot;:</span>

<span class="sd">         - *old* value</span>
<span class="sd">         - *new* value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cntr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">new</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;inf&#39;</span><span class="p">,</span> <span class="s">&#39;INF&#39;</span><span class="p">,</span> <span class="s">&#39;INFINITY&#39;</span><span class="p">,</span> <span class="s">&#39;-inf&#39;</span><span class="p">,</span> <span class="s">&#39;-INF&#39;</span><span class="p">,</span> <span class="s">&#39;-INFINITY&#39;</span><span class="p">]:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">old</span><span class="p">:</span>
                <span class="c">##  db = fba.flux_bounds.pop(b)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">new</span>
                <span class="n">cntr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Replaced {} </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> bounds with </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cntr</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.deleteAllFluxBoundsWithValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.deleteAllFluxBoundsWithValue">[docs]</a>    <span class="k">def</span> <span class="nf">deleteAllFluxBoundsWithValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete all flux bounds which have a specified value:</span>

<span class="sd">         - *value* the value of the flux bound(s) to delete</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cntr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
                <span class="n">cntr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Deleted {} </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> bounds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cntr</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

    <span class="c"># TODO: undelete Species</span></div>
<div class="viewcode-block" id="Model.deleteSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.deleteSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">deleteSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes a species object with id</span>

<span class="sd">        - *sid* the species id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">sid</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.deleteNonReactingSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.deleteNonReactingSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">deleteNonReactingSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simulate</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes all species that are not reagents (do not to take part in a reaction).</span>
<span class="sd">        *Warning* this deletion is permanent and greedy (not selective). Returns a list of (would be) deleted species</span>

<span class="sd">         - *simulate* [default=True] only return a list of the speciesId&#39;s that would have been deleted if False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">active_reagents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">R</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">S</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">S</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">active_reagents</span><span class="p">:</span>
                    <span class="n">active_reagents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">active_reagents</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">simulate</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Deleting non-reactive species&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">)</span>
        <span class="n">deleted_species</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">S</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">S</span><span class="p">]</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">active_reagents</span><span class="p">:</span>
                <span class="n">deleted_species</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">S</span><span class="p">]</span><span class="o">.</span><span class="n">getPid</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">simulate</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">deleteSpecies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">S</span><span class="p">]</span><span class="o">.</span><span class="n">getPid</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">())</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span> <span class="s">&quot; &quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">deleted_species</span>
</div>
<div class="viewcode-block" id="Model.getCompartment"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getCompartment">[docs]</a>    <span class="k">def</span> <span class="nf">getCompartment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a compartment object with *cid*</span>

<span class="sd">         - *cid* compartment ID</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="o">==</span> <span class="n">cid</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">c</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compartments</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">ERROR: multiple compartments with id </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> returning first&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cid</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.getReaction"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getReaction">[docs]</a>    <span class="k">def</span> <span class="nf">getReaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a reaction object with *id*</span>

<span class="sd">         - *rid* reaction ID</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="o">==</span> <span class="n">rid</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">r</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.getSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">getSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a species object with *sid*</span>

<span class="sd">         - *sid* a specied ID</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="o">==</span> <span class="n">sid</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">s</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.getReactionBounds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getReactionBounds">[docs]</a>    <span class="k">def</span> <span class="nf">getReactionBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the bounds of a reaction, returns a tuple of rid, lowerbound value, upperbound value and equality value (None means bound does not exist).</span>

<span class="sd">         - *rid* the reaction ID</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lb</span> <span class="o">=</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">eq</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">lb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByReactionID</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="s">&#39;lower&#39;</span><span class="p">)</span>
        <span class="n">ub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByReactionID</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="s">&#39;upper&#39;</span><span class="p">)</span>
        <span class="n">eq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByReactionID</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="s">&#39;equality&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lb</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                <span class="n">lb</span> <span class="o">=</span> <span class="n">lb</span><span class="o">.</span><span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lb</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ub</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                <span class="n">ub</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ub</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">eq</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                <span class="n">eq</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">eq</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rid</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">eq</span>
</div>
<div class="viewcode-block" id="Model.getReactionLowerBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getReactionLowerBound">[docs]</a>    <span class="k">def</span> <span class="nf">getReactionLowerBound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the lower bound of a reaction (it it exists) or None</span>

<span class="sd">         - *rid* the reaction ID</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lb</span> <span class="o">=</span> <span class="n">eq</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">lb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByReactionID</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="s">&#39;lower&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lb</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span> <span class="ow">and</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">value</span><span class="p">)):</span>
                <span class="n">lb</span> <span class="o">=</span> <span class="n">lb</span><span class="o">.</span><span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lb</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByReactionID</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="s">&#39;equality&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">eq</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c">#print(&#39;\nINFO: Lower bound defined as an equality ({})&#39;.format(rid))</span>
                <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                    <span class="n">lb</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lb</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lb</span>
</div>
<div class="viewcode-block" id="Model.getReactionUpperBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getReactionUpperBound">[docs]</a>    <span class="k">def</span> <span class="nf">getReactionUpperBound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the upper bound of a reaction (it it exists) or None</span>

<span class="sd">         - *rid* the reaction ID</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ub</span> <span class="o">=</span> <span class="n">eq</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">ub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByReactionID</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="s">&#39;upper&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ub</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span> <span class="ow">and</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">value</span><span class="p">)):</span>
                <span class="n">ub</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ub</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByReactionID</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="s">&#39;equality&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">eq</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c">#print(&#39;\nINFO: Upper bound defined as an equality ({})&#39;.format(rid))</span>
                <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                    <span class="n">ub</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ub</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ub</span>

    <span class="c">##  def getBoundByName(self, rid, bound):</span>
        <span class="c">##  &quot;&quot;&quot;</span>
        <span class="c">##  Return a FluxBound instance. Note this is an old name for the newer preferred method: `getFluxBoundByReactionID`</span>

         <span class="c">##  - *rid* the reaction ID</span>
         <span class="c">##  - *bound* the bound: &#39;upper&#39;, &#39;lower&#39;, &#39;equal&#39;</span>

        <span class="c">##  &quot;&quot;&quot;</span>
        <span class="c">##  print &#39;Deprecated: use *getFluxBoundByReactionID*&#39;</span>
        <span class="c">##  return self.getFluxBoundByReactionID(rid, bound)</span>
</div>
<div class="viewcode-block" id="Model.getFluxBoundByID"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getFluxBoundByID">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxBoundByID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a FluxBound with id</span>

<span class="sd">         - *fid* the fluxBound ID</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c_</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">c_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c_</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="o">==</span> <span class="n">fid</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">c_</span>
        <span class="k">return</span> <span class="n">c_</span>
</div>
<div class="viewcode-block" id="Model.getFluxBoundByReactionID"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getFluxBoundByReactionID">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxBoundByReactionID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">bound</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a FluxBound instance</span>

<span class="sd">         - *rid* the reaction ID</span>
<span class="sd">         - *bound* the bound: &#39;upper&#39;, &#39;lower&#39;, &#39;equality&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c_</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">c_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c_</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="n">rid</span> <span class="ow">and</span> <span class="n">c_</span><span class="o">.</span><span class="n">is_bound</span> <span class="o">==</span> <span class="n">bound</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">c_</span>
</div>
<div class="viewcode-block" id="Model.getFluxBoundsByReactionID"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getFluxBoundsByReactionID">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxBoundsByReactionID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all FluxBound instances connected to a reactionId as a tuple of valid</span>
<span class="sd">        (lower, upper, None) or (None, None, equality) or alternatively invalid (lower, upper, equality).</span>

<span class="sd">         - *rid* the reaction ID</span>

<span class="sd">         *under evaluation*</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">equality</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">c_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c_</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="n">rid</span> <span class="ow">and</span> <span class="n">c_</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;lower&#39;</span><span class="p">:</span>
                <span class="n">lower</span> <span class="o">=</span> <span class="n">c_</span>
            <span class="k">elif</span> <span class="n">c_</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="n">rid</span> <span class="ow">and</span> <span class="n">c_</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;upper&#39;</span><span class="p">:</span>
                <span class="n">upper</span> <span class="o">=</span> <span class="n">c_</span>
            <span class="k">elif</span> <span class="n">c_</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="n">rid</span> <span class="ow">and</span> <span class="n">c_</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;equality&#39;</span><span class="p">:</span>
                <span class="n">equality</span> <span class="o">=</span> <span class="n">c_</span>
            <span class="k">if</span> <span class="n">lower</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">upper</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">equality</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">equality</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Something strange in function getFluxBoundsByReactionID, returns: {}{}{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">equality</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">equality</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.getCompartmentIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getCompartmentIds">[docs]</a>    <span class="k">def</span> <span class="nf">getCompartmentIds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of compartment Ids, applies a substring search if substring is defined</span>

<span class="sd">         - *substring* search for this pattern anywhere in the id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">substring</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compartments</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compartments</span> <span class="k">if</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">getPid</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="Model.getSpeciesIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getSpeciesIds">[docs]</a>    <span class="k">def</span> <span class="nf">getSpeciesIds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of species Ids, applies a substring search if substring is defined</span>

<span class="sd">         - *substring* search for this pattern anywhere in the id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">substring</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="k">if</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="Model.getReactionIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getReactionIds">[docs]</a>    <span class="k">def</span> <span class="nf">getReactionIds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of reaction Ids, applies a substring search if substring is defined</span>

<span class="sd">         - *substring* search for this pattern anywhere in the id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">substring</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="k">if</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">getPid</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="Model.getReactionNames"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getReactionNames">[docs]</a>    <span class="k">def</span> <span class="nf">getReactionNames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of reaction names, applies a substring search if substring is defined</span>

<span class="sd">         - *substring* search for this pattern anywhere in the name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">substring</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="k">if</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Model.getFluxBoundIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getFluxBoundIds">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxBoundIds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of fluxbound Ids, applies a substring search if substring is defined</span>

<span class="sd">         - *substring* search for this pattern anywhere in the id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">substring</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span> <span class="k">if</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="Model.getObjectiveIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getObjectiveIds">[docs]</a>    <span class="k">def</span> <span class="nf">getObjectiveIds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of objective function Ids, applies a substring search if substring is defined</span>

<span class="sd">         - *substring* search for this pattern anywhere in the id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">substring</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="k">if</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="Model.getObjFuncValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getObjFuncValue">[docs]</a>    <span class="k">def</span> <span class="nf">getObjFuncValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the objective function value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">AO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getActiveObjective</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Objective {}: </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">AO</span><span class="o">.</span><span class="n">getPid</span><span class="p">(),</span> <span class="n">AO</span><span class="o">.</span><span class="n">operation</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">AO</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Model.getActiveObjective"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getActiveObjective">[docs]</a>    <span class="k">def</span> <span class="nf">getActiveObjective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the active objective object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">activeObjIdx</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;No active objective to get&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
    <span class="k">def</span> <span class="nf">setActiveObjective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objId</span><span class="p">):</span>
        <span class="n">idz</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">objId</span> <span class="ow">in</span> <span class="n">idz</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">activeObjIdx</span> <span class="o">=</span> <span class="n">idz</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">objId</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">activeObjIdx</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Objective {} (idx={}) set active&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">objId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">activeObjIdx</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Invalid ObjectiveId: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">objId</span><span class="p">))</span>

<div class="viewcode-block" id="Model.setBoundValueByName"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setBoundValueByName">[docs]</a>    <span class="k">def</span> <span class="nf">setBoundValueByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">bound</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated use setReactionBound</span>

<span class="sd">        Set a reaction bound</span>
<span class="sd">         - *rid* the reactions id</span>
<span class="sd">         - *value* the new value</span>
<span class="sd">         - *bound* this is either &#39;lower&#39; or &#39;upper&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Deprecated: use *setReactionBound*&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setReactionBound</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">bound</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.getGeneIdFromLabel"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getGeneIdFromLabel">[docs]</a>    <span class="k">def</span> <span class="nf">getGeneIdFromLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a gene label it returns the corresponding Gene id or None</span>

<span class="sd">         - *label*</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">g_</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">label</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">g_</span><span class="o">.</span><span class="n">getId</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="Model.setGeneInactive"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setGeneInactive">[docs]</a>    <span class="k">def</span> <span class="nf">setGeneInactive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g_id</span><span class="p">,</span> <span class="n">update_reactions</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Effectively deletes a gene by setting it&#39;s inactive flag while optionally updating the GPR associated reactions</span>

<span class="sd">         - *g_id* a gene ID</span>
<span class="sd">         - *update_reactions* [default=False] update the associated reactions fluxbounds</span>
<span class="sd">         - *lower* [default=0.0] the deactivated reaction lower bound</span>
<span class="sd">         - *upper* [default=0.0] the deactivated reaction upper bound</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGene</span><span class="p">(</span><span class="n">g_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">g</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">setInactive</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">update_reactions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">updateNetwork</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
</div>
<div class="viewcode-block" id="Model.setGeneActive"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setGeneActive">[docs]</a>    <span class="k">def</span> <span class="nf">setGeneActive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g_id</span><span class="p">,</span> <span class="n">update_reactions</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Effectively restores a gene by setting it&#39;s active flag</span>

<span class="sd">         - *g_id* a gene ID</span>
<span class="sd">         - *update_reactions* [default=False] update the associated reactions fluxbounds from the gene deletion bounds if they exist</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGene</span><span class="p">(</span><span class="n">g_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">g</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">setActive</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">update_reactions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">updateNetwork</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
</div>
<div class="viewcode-block" id="Model.updateNetwork"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.updateNetwork">[docs]</a>    <span class="k">def</span> <span class="nf">updateNetwork</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the reaction network based on gene activity. If reaction is deactivated then lower and upper bounds are used</span>

<span class="sd">         - *lower* [default=0.0] deactivated lower bound</span>
<span class="sd">         - *upper* [default=0.0] deactivated upper bound</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">:</span>
            <span class="n">active</span> <span class="o">=</span> <span class="n">g_</span><span class="o">.</span><span class="n">isProteinActive</span><span class="p">()</span>
            <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="n">g_</span><span class="o">.</span><span class="n">getProtein</span><span class="p">())</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">active</span> <span class="ow">and</span> <span class="n">R</span><span class="o">.</span><span class="n">__is_active__</span><span class="p">:</span>
                <span class="n">R</span><span class="o">.</span><span class="n">deactivateReaction</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">active</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">R</span><span class="o">.</span><span class="n">__is_active__</span><span class="p">:</span>
                <span class="n">R</span><span class="o">.</span><span class="n">reactivateReaction</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Model.resetAllGenes"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.resetAllGenes">[docs]</a>    <span class="k">def</span> <span class="nf">resetAllGenes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update_reactions</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets all genes to their default activity state (normally on)</span>

<span class="sd">        - *update_reactions* [default=False] update the associated reactions fluxbounds from the gene deletion bounds if they exist</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">:</span>
            <span class="n">g_</span><span class="o">.</span><span class="n">resetActivity</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateNetwork</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Model.setReactionBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setReactionBound">[docs]</a>    <span class="k">def</span> <span class="nf">setReactionBound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">bound</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a reaction bound</span>

<span class="sd">         - *rid* the reactions id</span>
<span class="sd">         - *value* the new value</span>
<span class="sd">         - *bound* this is either &#39;lower&#39; or &#39;upper&#39;, or &#39;equal&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByReactionID</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">bound</span><span class="p">)</span>
        <span class="c"># changed to no str() casting</span>
        <span class="k">if</span> <span class="n">c2</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">c2</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">reaction</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">operation</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># if the bound does not exist, create a new one</span>
            <span class="k">if</span> <span class="n">bound</span> <span class="o">==</span> <span class="s">&#39;upper&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">createReactionUpperBound</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">bound</span> <span class="o">==</span> <span class="s">&#39;lower&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">createReactionLowerBound</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="si">%s</span><span class="s"> is not a valid reaction name or </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s"> bound does not exist &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rid</span><span class="p">,</span><span class="n">bound</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.setReactionBounds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setReactionBounds">[docs]</a>    <span class="k">def</span> <span class="nf">setReactionBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set both the upper and lower bound of a reaction:</span>

<span class="sd">        - *rid* the good old reaction id</span>
<span class="sd">        - *lower* the lower bound value</span>
<span class="sd">        - *upper* the upper bound value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setReactionBound</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="s">&#39;lower&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setReactionBound</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="s">&#39;upper&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.setReactionLowerBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setReactionLowerBound">[docs]</a>    <span class="k">def</span> <span class="nf">setReactionLowerBound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a reactions lower bound (if it exists)</span>

<span class="sd">         - *rid* the reactions id</span>
<span class="sd">         - *value* the new value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setReactionBound</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="s">&#39;lower&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.setReactionUpperBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setReactionUpperBound">[docs]</a>    <span class="k">def</span> <span class="nf">setReactionUpperBound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a reactions upper bound (if it exists)</span>

<span class="sd">         - *rid* the reaction id</span>
<span class="sd">         - *value* the new value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setReactionBound</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="s">&#39;upper&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Model.getAllFluxBounds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getAllFluxBounds">[docs]</a>    <span class="k">def</span> <span class="nf">getAllFluxBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of all flux bounds [id:value]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">f_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">:</span>
            <span class="n">fid</span> <span class="o">=</span> <span class="n">f_</span><span class="o">.</span><span class="n">getId</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">fid</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;WARNING: duplicate fluxbound Id: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fid</span><span class="p">))</span>
            <span class="n">out</span><span class="p">[</span><span class="n">fid</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.setAllFluxBounds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setAllFluxBounds">[docs]</a>    <span class="k">def</span> <span class="nf">setAllFluxBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DEPRECATED! use setFluxBoundsFromDict()</span>

<span class="sd">        Sets all the fluxbounds present in bounds</span>

<span class="sd">         - *bounds* a dictionary of [fluxbound_id : value] pairs (not per reaction!!!)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">DEPRECATION WARNING: use setFluxBoundsFromDict instead of setAllFluxBounds</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFluxBoundsFromDict</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.setFluxBoundsFromDict"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setFluxBoundsFromDict">[docs]</a>    <span class="k">def</span> <span class="nf">setFluxBoundsFromDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets all the fluxbounds present in bounds</span>

<span class="sd">         - *bounds* a dictionary of [fluxbound_id : value] pairs (not per reaction!!!)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fbids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundIds</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">f_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">f_</span><span class="o">.</span><span class="n">getId</span><span class="p">()</span> <span class="ow">in</span> <span class="n">fbids</span><span class="p">:</span>
                <span class="n">f_</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="n">f_</span><span class="o">.</span><span class="n">getId</span><span class="p">()])</span>

</div>
<div class="viewcode-block" id="Model.renameObjectIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.renameObjectIds">[docs]</a>    <span class="k">def</span> <span class="nf">renameObjectIds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is designed for target=&quot;all&quot; other use may result in incomplete models.</span>

<span class="sd">         - *prefix* [None] if supplied add as a prefix</span>
<span class="sd">         - *suffix* [None] if supplied add as a suffix</span>
<span class="sd">         - *target* [&#39;all&#39;] specify what class of objects to rename</span>

<span class="sd">          - &#39;species&#39;</span>
<span class="sd">          - &#39;reactions&#39;</span>
<span class="sd">          - &#39;bounds&#39;</span>
<span class="sd">          - &#39;objectives&#39;</span>
<span class="sd">          - &#39;all&#39;</span>

<span class="sd">         - *ignore* [default=None] a list of id&#39;s to ignore</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ignore</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ignore</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">SUFFIX</span> <span class="o">=</span> <span class="n">PREFIX</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">suffix</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">prefix</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Either prefix or suffix must be defined&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prefix</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span>
            <span class="n">PREFIX</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">suffix</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span> <span class="o">=</span> <span class="n">suffix</span>
            <span class="n">SUFFIX</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c">##  self.id = self.id+suffix</span>
        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s">&#39;species&#39;</span> <span class="ow">or</span> <span class="n">target</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">PREFIX</span><span class="p">:</span>
                        <span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">+</span><span class="n">s</span><span class="o">.</span><span class="n">id</span>
                    <span class="k">if</span> <span class="n">SUFFIX</span><span class="p">:</span>
                        <span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="n">suffix</span>

        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s">&#39;reactions&#39;</span> <span class="ow">or</span> <span class="n">target</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">PREFIX</span><span class="p">:</span>
                        <span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">+</span><span class="n">s</span><span class="o">.</span><span class="n">id</span>
                    <span class="k">if</span> <span class="n">SUFFIX</span><span class="p">:</span>
                        <span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="n">suffix</span>
                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">reagents</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">PREFIX</span><span class="p">:</span>
                        <span class="n">r</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">+</span><span class="n">r</span><span class="o">.</span><span class="n">id</span>
                        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">species_ref</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
                            <span class="n">r</span><span class="o">.</span><span class="n">species_ref</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">+</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span>
                    <span class="k">if</span> <span class="n">SUFFIX</span><span class="p">:</span>
                        <span class="n">r</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="n">suffix</span>
                        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">species_ref</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
                            <span class="n">r</span><span class="o">.</span><span class="n">species_ref</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="o">+</span><span class="n">suffix</span>

        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s">&#39;bounds&#39;</span> <span class="ow">or</span> <span class="n">target</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">PREFIX</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">+</span><span class="n">s</span><span class="o">.</span><span class="n">id</span>
                    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">reaction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
                        <span class="n">s</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">+</span><span class="n">s</span><span class="o">.</span><span class="n">reaction</span>
                <span class="k">if</span> <span class="n">SUFFIX</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="n">suffix</span>
                    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">reaction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
                        <span class="n">s</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">reaction</span><span class="o">+</span><span class="n">suffix</span>

        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s">&#39;objectives&#39;</span> <span class="ow">or</span> <span class="n">target</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">PREFIX</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">+</span><span class="n">s</span><span class="o">.</span><span class="n">id</span>
                <span class="k">if</span> <span class="n">SUFFIX</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="n">suffix</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">fluxObjectives</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">PREFIX</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">+</span><span class="n">f</span><span class="o">.</span><span class="n">id</span>
                        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">reaction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">+</span><span class="n">f</span><span class="o">.</span><span class="n">reaction</span>
                    <span class="k">if</span> <span class="n">SUFFIX</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="n">suffix</span>
                        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">reaction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">reaction</span><span class="o">+</span><span class="n">suffix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buildStoichMatrix</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="Model.setPrefix"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setPrefix">[docs]</a>    <span class="k">def</span> <span class="nf">setPrefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is alpha stuff, target can be:</span>

<span class="sd">         - &#39;species&#39;</span>
<span class="sd">         - &#39;reactions&#39;</span>
<span class="sd">         - &#39;constraints&#39;</span>
<span class="sd">         - &#39;objectives&#39;</span>
<span class="sd">         - &#39;all&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">DEPRECATION WARNING: setPrefix will be removed, please use the new cmod.renameObjectIds() method instead</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s">&#39;constraints&#39;</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="s">&#39;bounds&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renameObjectIds</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="p">[])</span>

</div>
<div class="viewcode-block" id="Model.setSuffix"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setSuffix">[docs]</a>    <span class="k">def</span> <span class="nf">setSuffix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is alpha stuff, target can be:</span>

<span class="sd">         - &#39;species&#39;</span>
<span class="sd">         - &#39;reactions&#39;</span>
<span class="sd">         - &#39;constraints&#39;</span>
<span class="sd">         - &#39;objectives&#39;</span>
<span class="sd">         - &#39;all&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">DEPRECATION WARNING: setSuffix will be removed, please use the new cmod.renameObjectIds() method instead</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s">&#39;constraints&#39;</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="s">&#39;bounds&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renameObjectIds</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="p">[])</span>

</div>
<div class="viewcode-block" id="Model.setObjectiveFlux"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.setObjectiveFlux">[docs]</a>    <span class="k">def</span> <span class="nf">setObjectiveFlux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">coefficient</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">osense</span><span class="o">=</span><span class="s">&#39;maximize&#39;</span><span class="p">,</span> <span class="n">delete_objflx</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set single target reaction flux for the current active objective function.</span>

<span class="sd">         - *rid* a string containing a reaction id</span>
<span class="sd">         - *coefficient* [default=1] an objective flux coefficient</span>
<span class="sd">         - *osense* the optimization sense must be **maximize** or **minimize**</span>
<span class="sd">         - *delete_objflx* [default=True] delete all existing fluxObjectives in the active objective function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">rid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">(),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="si">%s</span><span class="s"> is not a reaction</span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">())</span>
        <span class="n">osense</span> <span class="o">=</span> <span class="n">osense</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">osense</span> <span class="o">==</span> <span class="s">&#39;max&#39;</span><span class="p">:</span> <span class="n">osense</span> <span class="o">=</span> <span class="s">&#39;maximize&#39;</span>
        <span class="k">if</span> <span class="n">osense</span> <span class="o">==</span> <span class="s">&#39;min&#39;</span><span class="p">:</span> <span class="n">osense</span> <span class="o">=</span> <span class="s">&#39;minimize&#39;</span>
        <span class="k">if</span> <span class="n">osense</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;maximise&#39;</span><span class="p">,</span> <span class="s">&#39;minimise&#39;</span><span class="p">]:</span>
            <span class="n">osense</span> <span class="o">=</span> <span class="n">osense</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;se&#39;</span><span class="p">,</span> <span class="s">&#39;ze&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">osense</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;maximize&#39;</span><span class="p">,</span> <span class="s">&#39;minimize&#39;</span><span class="p">],</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">osense must be [&#39;maximize&#39;, &#39;minimize&#39;] not </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">osense</span>
        <span class="k">if</span> <span class="n">delete_objflx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">activeObjIdx</span><span class="p">]</span><span class="o">.</span><span class="n">fluxObjectives</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FO</span> <span class="o">=</span> <span class="n">FluxObjective</span><span class="p">(</span><span class="s">&#39;{}_{}_fluxobj&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">activeObjIdx</span><span class="p">]</span><span class="o">.</span><span class="n">getPid</span><span class="p">(),</span> <span class="n">rid</span><span class="p">),</span> <span class="n">rid</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">activeObjIdx</span><span class="p">]</span><span class="o">.</span><span class="n">addFluxObjective</span><span class="p">(</span><span class="n">FO</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">activeObjIdx</span><span class="p">]</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="n">osense</span>
</div>
<div class="viewcode-block" id="Model.sortReactionsById"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.sortReactionsById">[docs]</a>    <span class="k">def</span> <span class="nf">sortReactionsById</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sorts the reactions by Reaction.id uses the python string sort</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">reactions2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">reactId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">()</span>
        <span class="n">reactId</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reactId</span><span class="p">:</span>
            <span class="n">reactions2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">reactions2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__updateGeneIdx__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">gpr_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">:</span>
            <span class="n">gpr_</span><span class="o">.</span><span class="n">buildEvalFunc</span><span class="p">()</span>
        <span class="k">del</span> <span class="n">reactions2</span>
</div>
<div class="viewcode-block" id="Model.sortSpeciesById"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.sortSpeciesById">[docs]</a>    <span class="k">def</span> <span class="nf">sortSpeciesById</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sorts the reaction list by Reaction.id uses the python string sort</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Call developer about this&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.getExchangeReactions"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getExchangeReactions">[docs]</a>    <span class="k">def</span> <span class="nf">getExchangeReactions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns reaction instances where the &#39;is_exchange&#39; attribute set to True. This is by default</span>
<span class="sd">        reactions that contain a boundary species.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">is_exchange</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Model.getExchangeReactionIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getExchangeReactionIds">[docs]</a>    <span class="k">def</span> <span class="nf">getExchangeReactionIds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns id&#39;s of reactions where the &#39;is_exchange&#39; attribute set to True. This is by default</span>
<span class="sd">        reactions that contain a boundary species.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">is_exchange</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Model.getReactionValues"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getReactionValues">[docs]</a>    <span class="k">def</span> <span class="nf">getReactionValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">only_exchange</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of ReactionID : ReactionValue pairs:</span>

<span class="sd">         - *only_exchange* [default=False] only return the reactions labelled as exchange</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">reacts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">only_exchange</span><span class="p">:</span>
            <span class="n">reacts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getExchangeReactionIds</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reacts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">rid</span> <span class="ow">in</span> <span class="n">reacts</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">rid</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.getSolutionVector"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getSolutionVector">[docs]</a>    <span class="k">def</span> <span class="nf">getSolutionVector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a vector of solution values</span>

<span class="sd">         - *names* [default=False] if True return a solution vector and list of names</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buildStoichMatrix</span><span class="p">()</span>
        <span class="n">J</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">.</span><span class="n">col</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">names</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">J</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">J</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">.</span><span class="n">col</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Model.getReversibleReactionIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getReversibleReactionIds">[docs]</a>    <span class="k">def</span> <span class="nf">getReversibleReactionIds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of reversible reaction Id&#39;s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">r_</span><span class="o">.</span><span class="n">reversible</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_</span><span class="o">.</span><span class="n">getPid</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">output</span>
</div>
<div class="viewcode-block" id="Model.getIrreversibleReactionIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getIrreversibleReactionIds">[docs]</a>    <span class="k">def</span> <span class="nf">getIrreversibleReactionIds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of irreversible reaction Id&#39;s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">r_</span><span class="o">.</span><span class="n">reversible</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_</span><span class="o">.</span><span class="n">getPid</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">output</span>
</div>
<div class="viewcode-block" id="Model.getBoundarySpeciesIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getBoundarySpeciesIds">[docs]</a>    <span class="k">def</span> <span class="nf">getBoundarySpeciesIds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return all boundary species associated with reaction</span>

<span class="sd">         - rid [default=None] by default return all boundary species in a model, alternatively a string containing a reaction id or list of reaction id&#39;s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rid</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rid</span> <span class="o">=</span> <span class="p">[</span><span class="n">rid</span><span class="p">]</span>
        <span class="n">bspec</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r_</span> <span class="ow">in</span> <span class="n">rid</span><span class="p">:</span>
            <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="n">r_</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">s_</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">s_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bspec</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">s_</span><span class="p">)</span><span class="o">.</span><span class="n">is_boundary</span><span class="p">:</span>
                    <span class="n">bspec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bspec</span>
</div>
<div class="viewcode-block" id="Model.findFluxesForConnectedSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.findFluxesForConnectedSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">findFluxesForConnectedSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metab</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of (reaction, flux value) pairs that this metabolite appears as a reagent of</span>

<span class="sd">         - *metab* the metabolite name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;DEPRECATION WARNING: please use cmod.getFluxesAssociatedWithSpecies()&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxesAssociatedWithSpecies</span><span class="p">(</span><span class="n">metab</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.getFluxesAssociatedWithSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getFluxesAssociatedWithSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxesAssociatedWithSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metab</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of (reaction, flux value) pairs that this metabolite appears as a reagent in</span>

<span class="sd">         - *metab* the metabolite name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSpecies</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="si">%s</span><span class="s"> is not a valid metabolite name!&#39;</span> <span class="o">%</span> <span class="n">metab</span>
        <span class="k">for</span> <span class="n">r_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">metab</span><span class="p">)</span><span class="o">.</span><span class="n">isReagentOf</span><span class="p">():</span>
            <span class="c"># if cmod.getReaction(r_).getValue() != 0.0:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">r_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="n">r_</span><span class="p">)</span><span class="o">.</span><span class="n">getValue</span><span class="p">()])</span>
            <span class="c">#print r_, cmod.getReaction(r_).getValue()</span>
        <span class="k">return</span> <span class="n">output</span>
</div>
<div class="viewcode-block" id="Model.splitEqualityFluxBounds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.splitEqualityFluxBounds">[docs]</a>    <span class="k">def</span> <span class="nf">splitEqualityFluxBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Splits any equalit flux bounds into lower and upper bounds.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ebs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_bounds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">b_</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;equality&#39;</span><span class="p">:</span>
                <span class="n">ebs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_</span><span class="o">.</span><span class="n">getPid</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">e_</span> <span class="ow">in</span> <span class="n">ebs</span><span class="p">:</span>
            <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxBoundByID</span><span class="p">(</span><span class="n">e_</span><span class="p">)</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">getReactionId</span><span class="p">()</span>
            <span class="n">V</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deleteBoundsForReactionId</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">createReactionLowerBound</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">createReactionUpperBound</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">ebs</span>
</div>
<div class="viewcode-block" id="Model.buildStoichMatrix"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.buildStoichMatrix">[docs]</a>    <span class="k">def</span> <span class="nf">buildStoichMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix_type</span><span class="o">=</span><span class="s">&#39;numpy&#39;</span><span class="p">,</span> <span class="n">only_return</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build the stoichiometric matrix N and additional constraint matrix CN (if required)</span>

<span class="sd">         - *matrix_type* [default=&#39;numpy&#39;] the type of matrix to use to generate constraints</span>

<span class="sd">           - *numpy* a NumPy matrix default</span>
<span class="sd">           - *sympy* a SymPy symbolic matrix, if available note the denominator limit can be set in ``CBModel.__CBCONFIG__[&#39;SYMPY_DENOM_LIMIT&#39;] = 10**12``</span>
<span class="sd">           - *scipy_csr* create using NumPy but store as SciPy csr_sparse</span>

<span class="sd">        - *only_return* [default=False] **IMPORTANT** only returns the stoichiometric matrix and constraint matrix (if required),</span>
<span class="sd">          does not update the model</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&#39;Species:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">())</span>
        <span class="n">var_spec</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">is_boundary</span><span class="p">]</span>
        <span class="n">var_spec_id</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">is_boundary</span><span class="p">]</span>
        <span class="n">reac_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">()</span>
        <span class="n">num_col</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">)</span>
        <span class="n">num_row</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_spec</span><span class="p">)</span>
        <span class="n">sym_dlim</span> <span class="o">=</span> <span class="n">__CBCONFIG__</span><span class="p">[</span><span class="s">&#39;SYMPY_DENOM_LIMIT&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&#39;N-dimension = (</span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_row</span><span class="p">,</span> <span class="n">num_col</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">matrix_type</span> <span class="o">==</span> <span class="s">&#39;scipy_csr&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">HAVE_SCIPY</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">SciPy required for scipy_csr matrices&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">matrix_type</span> <span class="o">==</span> <span class="s">&#39;sympy&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">HAVE_SYMPY</span><span class="p">:</span>
                <span class="n">N</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_row</span><span class="p">,</span> <span class="n">num_col</span><span class="p">)</span>
                <span class="n">RHS</span> <span class="o">=</span> <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">numbers</span><span class="o">.</span><span class="n">Zero</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_row</span><span class="p">)]</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">INFO: using SymPy for N&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">SymPy required for SymPy matrices&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_row</span><span class="p">,</span> <span class="n">num_col</span><span class="p">))</span>
            <span class="n">RHS</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_row</span><span class="p">)</span>

        <span class="n">SGO</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">matrix_type</span> <span class="o">==</span> <span class="s">&#39;sympy&#39;</span><span class="p">:</span>
            <span class="n">SGO</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_col</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">getPid</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">getStoichiometry</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">reag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">getStoichiometry</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">reag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">var_spec_id</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">__DEBUG__</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&#39;{}: setting reagent {} to {} (idx={},{})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">getPid</span><span class="p">(),</span> <span class="n">reag</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reag</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">var_spec_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">reag</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">c</span><span class="p">))</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">var_spec_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">reag</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">SGO</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">N</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                            <span class="n">N</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="n">reag</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">(</span><span class="n">sym_dlim</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">N</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="n">reag</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">(</span><span class="n">sym_dlim</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">N</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">N</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">reag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">N</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="n">reag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">matrix_type</span> <span class="o">==</span> <span class="s">&#39;scipy_csr&#39;</span><span class="p">:</span>
            <span class="n">N2</span> <span class="o">=</span> <span class="n">csr_matrix</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">N</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">StructMatrixLP</span><span class="p">(</span><span class="n">N2</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_row</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_col</span><span class="p">)),</span> <span class="n">row</span><span class="o">=</span><span class="n">var_spec_id</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="n">RHS</span><span class="p">)</span>
            <span class="n">N</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">eliminate_zeros</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">StructMatrixLP</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_row</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_col</span><span class="p">)),</span> <span class="n">row</span><span class="o">=</span><span class="n">var_spec_id</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="n">RHS</span><span class="p">)</span>

        <span class="c"># build and append additional constraint matric</span>
        <span class="n">CM</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_constraints</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">crows</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_constraints</span><span class="p">)</span>
            <span class="n">crows</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">ccols</span> <span class="o">=</span> <span class="n">reac_id</span>
            <span class="n">cnum_col</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ccols</span><span class="p">)</span>
            <span class="n">cnum_row</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">crows</span><span class="p">)</span>
            <span class="n">Coperators</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;E&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">cnum_row</span>

            <span class="k">if</span> <span class="n">matrix_type</span> <span class="o">==</span> <span class="s">&#39;sympy&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">HAVE_SYMPY</span><span class="p">:</span>
                    <span class="n">CM</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">cnum_row</span><span class="p">,</span> <span class="n">cnum_col</span><span class="p">)</span>
                    <span class="n">CRHS</span> <span class="o">=</span> <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">numbers</span><span class="o">.</span><span class="n">Zero</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cnum_row</span><span class="p">)]</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;INFO: using SymPy for CM&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">SymPy not available&#39;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">CM</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">cnum_row</span><span class="p">,</span><span class="n">cnum_col</span><span class="p">))</span>
                <span class="n">CRHS</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">cnum_row</span><span class="p">)</span>
            <span class="n">SGO</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">matrix_type</span> <span class="o">==</span> <span class="s">&#39;sympy&#39;</span><span class="p">:</span>
                <span class="n">SGO</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cnum_row</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">flx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_constraints</span><span class="p">[</span><span class="n">crows</span><span class="p">[</span><span class="n">cs</span><span class="p">]][</span><span class="s">&#39;fluxes&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">SGO</span><span class="p">:</span>
                        <span class="n">CM</span><span class="p">[</span><span class="n">cs</span><span class="p">,</span><span class="n">ccols</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">flx</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">flx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">CM</span><span class="p">[</span><span class="n">cs</span><span class="p">,</span><span class="n">ccols</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">flx</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="n">flx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">(</span><span class="n">sym_dlim</span><span class="p">)</span>

                    <span class="n">Coperators</span><span class="p">[</span><span class="n">cs</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_constraints</span><span class="p">[</span><span class="n">crows</span><span class="p">[</span><span class="n">cs</span><span class="p">]][</span><span class="s">&#39;operator&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">SGO</span><span class="p">:</span>
                        <span class="n">CRHS</span><span class="p">[</span><span class="n">cs</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_constraints</span><span class="p">[</span><span class="n">crows</span><span class="p">[</span><span class="n">cs</span><span class="p">]][</span><span class="s">&#39;rhs&#39;</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">CRHS</span><span class="p">[</span><span class="n">cs</span><span class="p">]</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_constraints</span><span class="p">[</span><span class="n">crows</span><span class="p">[</span><span class="n">cs</span><span class="p">]][</span><span class="s">&#39;rhs&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">(</span><span class="n">sym_dlim</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">matrix_type</span> <span class="o">==</span> <span class="s">&#39;scipy_csr&#39;</span><span class="p">:</span>
                <span class="n">CM2</span> <span class="o">=</span> <span class="n">csr_matrix</span><span class="p">(</span><span class="n">CM</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">CM</span>
                <span class="n">CM</span> <span class="o">=</span> <span class="n">StructMatrixLP</span><span class="p">(</span><span class="n">CM2</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">cnum_row</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">cnum_col</span><span class="p">)),</span> <span class="n">row</span><span class="o">=</span><span class="n">crows</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">ccols</span><span class="p">,</span>\
                            <span class="n">rhs</span><span class="o">=</span><span class="n">CRHS</span><span class="p">,</span> <span class="n">operators</span><span class="o">=</span><span class="n">Coperators</span><span class="p">)</span>
                <span class="n">CM</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">eliminate_zeros</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">CM</span> <span class="o">=</span> <span class="n">StructMatrixLP</span><span class="p">(</span><span class="n">CM</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">cnum_row</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">cnum_col</span><span class="p">)),</span> <span class="n">row</span><span class="o">=</span><span class="n">crows</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">ccols</span><span class="p">,</span>\
                            <span class="n">rhs</span><span class="o">=</span><span class="n">CRHS</span><span class="p">,</span> <span class="n">operators</span><span class="o">=</span><span class="n">Coperators</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">only_return</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
            <span class="k">if</span> <span class="n">CM</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CM</span> <span class="o">=</span> <span class="n">CM</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;INFO: Model stoichiometry not updated.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">CM</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">CM</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">N</span>

</div>
<div class="viewcode-block" id="Model.createSingleGeneEffectMap"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createSingleGeneEffectMap">[docs]</a>    <span class="k">def</span> <span class="nf">createSingleGeneEffectMap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This takes a model and analyses the logical gene expression patterns. This only needs to be done once,</span>
<span class="sd">        the result is a dictionary that has boolean effect patterns as keys and the (list of) genes that give rise to</span>
<span class="sd">        those patterns as values. This map is used by the single gene deletion method for further analysis.</span>

<span class="sd">        Note this dictionary can also be stored and retrieved separately as long as the model structure is not changed i.e.</span>
<span class="sd">        the gene associations themselves or order of reactions (stored as the special entry &#39;keyJ&#39;).</span>

<span class="sd">        Stored as self.__single_gene_effect_map__</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fba2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="c">#cbm.analyzeModel(fba2)</span>

        <span class="n">geneIds</span> <span class="o">=</span> <span class="n">fba2</span><span class="o">.</span><span class="n">getGeneIds</span><span class="p">()</span>
        <span class="n">wtpr</span> <span class="o">=</span> <span class="n">fba2</span><span class="o">.</span><span class="n">getAllProteinActivities</span><span class="p">()</span>
        <span class="n">wtrn</span> <span class="o">=</span> <span class="n">fba2</span><span class="o">.</span><span class="n">getReactionIds</span><span class="p">()</span>
        <span class="n">wtrn</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">cpress</span> <span class="o">=</span> <span class="p">{</span><span class="n">binHash</span><span class="p">(</span><span class="n">wtrn</span><span class="p">,</span> <span class="n">wtpr</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;wt&#39;</span><span class="p">]}</span>

        <span class="c">#print(cpress)</span>

        <span class="n">geneidcache</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">t0a</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%H:%M:%S&#39;</span><span class="p">))</span>
        <span class="n">cntr</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="n">geneIds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">g_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">geneidcache</span><span class="p">:</span>
                <span class="n">geneidcache</span><span class="p">[</span><span class="n">g_</span><span class="p">]</span> <span class="o">=</span> <span class="n">fba2</span><span class="o">.</span><span class="n">getGene</span><span class="p">(</span><span class="n">g_</span><span class="p">)</span>
            <span class="n">geneidcache</span><span class="p">[</span><span class="n">g_</span><span class="p">]</span><span class="o">.</span><span class="n">setInactive</span><span class="p">()</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">fba2</span><span class="o">.</span><span class="n">getAllProteinActivities</span><span class="p">()</span>
            <span class="n">bhash</span> <span class="o">=</span> <span class="n">binHash</span><span class="p">(</span><span class="n">wtrn</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bhash</span> <span class="ow">in</span> <span class="n">cpress</span><span class="p">:</span>
                <span class="n">cpress</span><span class="p">[</span><span class="n">bhash</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cpress</span><span class="p">[</span><span class="n">bhash</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">g_</span><span class="p">]</span>
            <span class="n">geneidcache</span><span class="p">[</span><span class="n">g_</span><span class="p">]</span><span class="o">.</span><span class="n">setActive</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0a</span> <span class="o">&gt;</span> <span class="mf">20.0</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">cntr</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%H:%M:%S&#39;</span><span class="p">))</span>
                <span class="n">t0a</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">cntr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="n">cntr</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%H:%M:%S&#39;</span><span class="p">))</span>
        <span class="n">cpress</span><span class="p">[</span><span class="s">&#39;keyJ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">wtrn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__single_gene_effect_map__</span> <span class="o">=</span> <span class="n">cpress</span>
        <span class="k">del</span> <span class="n">geneidcache</span><span class="p">,</span> <span class="n">fba2</span><span class="p">,</span> <span class="n">cpress</span>
</div>
<div class="viewcode-block" id="Model.testGeneProteinAssociations"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.testGeneProteinAssociations">[docs]</a>    <span class="k">def</span> <span class="nf">testGeneProteinAssociations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method will test the GeneProtein associations and return a list of protein, association pairs</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpr</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">g_</span><span class="o">.</span><span class="n">evalAssociation</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">g_</span><span class="o">.</span><span class="n">protein</span><span class="p">,</span> <span class="n">g_</span><span class="o">.</span><span class="n">assoc</span><span class="p">))</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;Error in GPR for reaction: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">g_</span><span class="o">.</span><span class="n">protein</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Model.exportFVAdata"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.exportFVAdata">[docs]</a>    <span class="k">def</span> <span class="nf">exportFVAdata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export the fva data as an array and list of reaction id&#39;s</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># investigate the use of numpy index arrays here</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</div>
<div class="viewcode-block" id="Model.createGroup"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.createGroup">[docs]</a>    <span class="k">def</span> <span class="nf">createGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an empty group with</span>

<span class="sd">         - *gid* the unique group id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="n">Group</span><span class="p">(</span><span class="n">gid</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.addGroup"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.addGroup">[docs]</a>    <span class="k">def</span> <span class="nf">addGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an instantiated group object to the model</span>

<span class="sd">         - *obj* the Group instance</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">getId</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGroupIds</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;ERROR: Group with id </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> already exists.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">getId</span><span class="p">()))</span>
            <span class="k">del</span> <span class="n">obj</span>
</div>
<div class="viewcode-block" id="Model.deleteGroup"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.deleteGroup">[docs]</a>    <span class="k">def</span> <span class="nf">deleteGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete a group with</span>

<span class="sd">         - *gid* the unique group id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGroupIds</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">gid</span> <span class="ow">in</span> <span class="n">gids</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">gids</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">gid</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;ERROR: Group with id </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> does not exist.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gid</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Model.getGroup"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getGroup">[docs]</a>    <span class="k">def</span> <span class="nf">getGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a group with</span>

<span class="sd">         - *gid* the unique group id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">g_</span><span class="o">.</span><span class="n">getId</span><span class="p">()</span> <span class="o">==</span> <span class="n">gid</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">g_</span>
        <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="Model.getGroupIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Model.getGroupIds">[docs]</a>    <span class="k">def</span> <span class="nf">getGroupIds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete all group ids</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">]</span>

</div></div>
<div class="viewcode-block" id="Objective"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective">[docs]</a><span class="k">class</span> <span class="nc">Objective</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An objective function</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fluxObjectives</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="c">##  fluxObjectiveNames = None</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">value</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">operation</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="k">if</span> <span class="n">operation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;maximize&#39;</span><span class="p">,</span> <span class="s">&#39;maximise&#39;</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="s">&#39;maximize&#39;</span>
        <span class="k">elif</span> <span class="n">operation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;minimize&#39;</span><span class="p">,</span> <span class="s">&#39;minimise&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="s">&#39;minimize&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;WARNING: Invalid operation: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">operation</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluxObjectives</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartment</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__delattr__</span><span class="p">(</span><span class="s">&#39;compartment&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Objective.setOperation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.setOperation">[docs]</a>    <span class="k">def</span> <span class="nf">setOperation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the objective operation (sense)</span>

<span class="sd">         - *operation* [default=&#39;maximize&#39;] one of &#39;maximize&#39;, &#39;maximise&#39;, &#39;max&#39;, &#39;minimize&#39;, &#39;minimise&#39;, &#39;min&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">operation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;maximize&#39;</span><span class="p">,</span> <span class="s">&#39;maximise&#39;</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="s">&#39;maximize&#39;</span>
        <span class="k">elif</span> <span class="n">operation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;minimize&#39;</span><span class="p">,</span> <span class="s">&#39;minimise&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="s">&#39;minimize&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;WARNING: Invalid operation: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">operation</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Objective.getOperation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.getOperation">[docs]</a>    <span class="k">def</span> <span class="nf">getOperation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the operation or sense of the objective</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span>
</div>
<div class="viewcode-block" id="Objective.addFluxObjective"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.addFluxObjective">[docs]</a>    <span class="k">def</span> <span class="nf">addFluxObjective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a FluxObjective instance to the Objective</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fobj</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxObjectiveIDs</span><span class="p">():</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">WARNING: a flux objective with id </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> already exists ... not adding!</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fobj</span><span class="o">.</span><span class="n">getPid</span><span class="p">()))</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluxObjectives</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fobj</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Objective.createFluxObjectives"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.createFluxObjectives">[docs]</a>    <span class="k">def</span> <span class="nf">createFluxObjectives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fluxlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and add flux objective objects to this objective function.</span>

<span class="sd">         - *fluxlist* a list of one or more (&#39;coefficient&#39;, &#39;rid&#39;) pairs</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FOreact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxObjectiveReactions</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">fluxlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">FOreact</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addFluxObjective</span><span class="p">(</span><span class="n">FluxObjective</span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;_fobj&#39;</span><span class="p">,</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Objective {} already contains flux {} ... skipping!</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getPid</span><span class="p">(),</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</div>
<div class="viewcode-block" id="Objective.deleteAllFluxObjectives"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.deleteAllFluxObjectives">[docs]</a>    <span class="k">def</span> <span class="nf">deleteAllFluxObjectives</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete all flux objectives</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluxObjectives</span> <span class="o">=</span> <span class="p">[]</span>
</div>
<div class="viewcode-block" id="Objective.getFluxObjectiveIDs"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.getFluxObjectiveIDs">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxObjectiveIDs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of ObjectiveFlux ids, for the reaction id&#39;s use *getFluxObjectiveReactions()*</span>
<span class="sd">        or for coefficient, fluxobjective pairs use *getFluxObjectiveData()*</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxObjectives</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Objective.getFluxObjectiveForReaction"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.getFluxObjectiveForReaction">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxObjectiveForReaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the FluxObjective associated with the suplied rid. If there is more than fluxObjective associated with a reaction (illegal)</span>
<span class="sd">        then a list of fluxObjectives is returned.</span>

<span class="sd">         *rid* a reaction id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">fo_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxObjectives</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fo_</span><span class="o">.</span><span class="n">reaction</span> <span class="o">==</span> <span class="n">rid</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fo</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">=</span> <span class="n">fo_</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">fo</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fo_</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">WARNING: multiple fluxObjectives match rid: {}</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rid</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">=</span> <span class="p">[</span><span class="n">fo</span><span class="p">]</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fo_</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">WARNING: multiple fluxObjectives match rid: {}</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rid</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">fo</span>
</div>
<div class="viewcode-block" id="Objective.getFluxObjectiveReactions"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.getFluxObjectiveReactions">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxObjectiveReactions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of reactions that are used as FluxObjectives</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">reaction</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxObjectives</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Objective.getFluxObjectiveData"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.getFluxObjectiveData">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxObjectiveData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of ObjectiveFunction components as (coefficient, flux) pairs</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">f</span><span class="o">.</span><span class="n">coefficient</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">reaction</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxObjectives</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Objective.getFluxObjective"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.getFluxObjective">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxObjective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the flux objective with id.</span>

<span class="sd">         - *foid* the flux objective id returns either an object or a list if there are multiply defined flux objectives</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">fo_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxObjectives</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fo_</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="o">==</span> <span class="n">foid</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fo</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">=</span> <span class="n">fo_</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">fo</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fo_</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;ERROR: multiple FluxBounds have id: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">foid</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">=</span> <span class="p">[</span><span class="n">fo</span><span class="p">]</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fo_</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;ERROR: multiple FluxBounds have id: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">foid</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">fo</span>

</div>
<div class="viewcode-block" id="Objective.getFluxObjectives"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.getFluxObjectives">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxObjectives</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the list of FluxObjective objects.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxObjectives</span>
</div>
<div class="viewcode-block" id="Objective.getValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.getValue">[docs]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current value of the attribute (input/solution)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</div>
<div class="viewcode-block" id="Objective.setValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Objective.setValue">[docs]</a>    <span class="k">def</span> <span class="nf">setValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the attribute &#39;&#39;value&#39;&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</div></div>
<div class="viewcode-block" id="FluxObjective"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.FluxObjective">[docs]</a><span class="k">class</span> <span class="nc">FluxObjective</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A weighted flux that appears in an objective function</span>

<span class="sd">    NOTE: reaction is a string containing a reaction id</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reaction</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">coefficient</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="n">coefficient</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">reaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">=</span> <span class="n">coefficient</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartment</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__delattr__</span><span class="p">(</span><span class="s">&#39;compartment&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getReactionId</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span>

    <span class="k">def</span> <span class="nf">getCoefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span>

    <span class="k">def</span> <span class="nf">setReactionId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">reaction</span>

    <span class="k">def</span> <span class="nf">setCoefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">=</span> <span class="n">coefficient</span>
</div>
<div class="viewcode-block" id="Compartment"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Compartment">[docs]</a><span class="k">class</span> <span class="nc">Compartment</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A compartment&quot;&quot;&quot;</span>
    <span class="n">size</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">dimensions</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">volume</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         - *cid* comapartment id</span>
<span class="sd">         - *name* optional compartment name</span>
<span class="sd">         - *size* compartment size, [default=1]</span>
<span class="sd">         - *dimensions* compartment spatial dimensions [default=3]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPid</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">if</span> <span class="n">volume</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">=</span> <span class="n">dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="Compartment.containsSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Compartment.containsSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">containsSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the species contained in this compartment</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">species</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">compartment</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPid</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Compartment.containsReactions"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Compartment.containsReactions">[docs]</a>    <span class="k">def</span> <span class="nf">containsReactions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the species contained in this compartment</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">reactions</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">compartment</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPid</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Compartment.getSize"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Compartment.getSize">[docs]</a>    <span class="k">def</span> <span class="nf">getSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the compartment size</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
</div>
<div class="viewcode-block" id="Compartment.getDimensions"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Compartment.getDimensions">[docs]</a>    <span class="k">def</span> <span class="nf">getDimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the compartment dimensions</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span>
</div>
<div class="viewcode-block" id="Compartment.setSize"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Compartment.setSize">[docs]</a>    <span class="k">def</span> <span class="nf">setSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the compartment size</span>

<span class="sd">         - *size* the new compartment size</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
</div>
<div class="viewcode-block" id="Compartment.setDimensions"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Compartment.setDimensions">[docs]</a>    <span class="k">def</span> <span class="nf">setDimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the compartment dimensions</span>

<span class="sd">         - *dimensions* set the new compartment dimensions</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">=</span> <span class="n">dimensions</span>
</div></div>
<div class="viewcode-block" id="GroupMemberAttributes"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GroupMemberAttributes">[docs]</a><span class="k">class</span> <span class="nc">GroupMemberAttributes</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Contains the shared attributes of the group members (equivalent to SBML annotation on ListOfMembers)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>
</div>
<div class="viewcode-block" id="Group"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group">[docs]</a><span class="k">class</span> <span class="nc">Group</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Container for SBML groups</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">members</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">member_ids</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s">&#39;collection&#39;</span>
    <span class="n">_kinds_</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;collection&#39;</span><span class="p">,</span> <span class="s">&#39;partonomy&#39;</span><span class="p">,</span> <span class="s">&#39;classification&#39;</span><span class="p">)</span>
    <span class="n">_group_member_ids_</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_member_attributes_</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
        <span class="c">#delattr(self, &#39;compartment&#39;) # doesn&#39;t work</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setId</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">member_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_group_member_ids_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span> <span class="o">=</span> <span class="n">GroupMemberAttributes</span><span class="p">()</span>

<div class="viewcode-block" id="Group.clone"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.clone">[docs]</a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a clone of this object. Note the for Groups this is a shallow copy, in that the reference</span>
<span class="sd">        objects themselves are not cloned only the group (and attributes)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">cpy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">cpy</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cpy</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="p">[:])</span>
        <span class="k">return</span> <span class="n">cpy</span>
</div>
<div class="viewcode-block" id="Group.addMember"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.addMember">[docs]</a>    <span class="k">def</span> <span class="nf">addMember</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add member CBMPy object(s) to the group</span>

<span class="sd">         - *obj* either a single, tuple or list of CBMPy objects</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">o_</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o_</span><span class="p">,</span> <span class="n">Fbase</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">o_</span><span class="o">.</span><span class="n">getId</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">member_ids</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;ERROR object {} already exist in group.</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">o_</span><span class="o">.</span><span class="n">getId</span><span class="p">()))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o_</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">member_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o_</span><span class="o">.</span><span class="n">getId</span><span class="p">())</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o_</span><span class="p">,</span> <span class="n">Group</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_group_member_ids_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o_</span><span class="o">.</span><span class="n">getId</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;ERROR: object {} is not a valid CBMPy object .</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">o_</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Group.deleteMember"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.deleteMember">[docs]</a>    <span class="k">def</span> <span class="nf">deleteMember</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes a group member with group id.</span>

<span class="sd">         - *oid* group member id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">oid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">member_ids</span><span class="p">:</span>
            <span class="n">oidx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member_ids</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">oid</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">oidx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">member_ids</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">oidx</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Group</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_group_member_ids_</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">oid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Error object {} is not a member of group.</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">oid</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Group.getMembers"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.getMembers">[docs]</a>    <span class="k">def</span> <span class="nf">getMembers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_set</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the member objects of the group.</span>

<span class="sd">         - *as_set* return objects as a set rather than a list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">as_set</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.getMemberIDs"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.getMemberIDs">[docs]</a>    <span class="k">def</span> <span class="nf">getMemberIDs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_set</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the ids of the member objects.</span>

<span class="sd">         - *as_set* return id&#39;s as a set rather than a list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">as_set</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">member_ids</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">member_ids</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.getKind"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.getKind">[docs]</a>    <span class="k">def</span> <span class="nf">getKind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the group kind</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span>
</div>
<div class="viewcode-block" id="Group.setKind"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.setKind">[docs]</a>    <span class="k">def</span> <span class="nf">setKind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the kind or type of the group, this must be one of: &#39;collection&#39;, &#39;partonomy&#39;, &#39;classification&#39;.</span>

<span class="sd">         - *kind* the kind</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">kind</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kinds_</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Kind must be one of: {}</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kinds_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">kind</span>
</div>
<div class="viewcode-block" id="Group.addSharedMIRIAMannotation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.addSharedMIRIAMannotation">[docs]</a>    <span class="k">def</span> <span class="nf">addSharedMIRIAMannotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qual</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">mid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a qualified MIRIAM annotation or entity to the list of members (all) rather than the group itself:</span>

<span class="sd">         - *qual* a Biomodels biological qualifier e.g. &quot;is&quot; &quot;isEncodedBy&quot;</span>
<span class="sd">         - *entity* a MIRIAM resource entity e.g. &quot;ChEBI&quot;</span>
<span class="sd">         - *mid* the entity id e.g. CHEBI:17158 or fully qualifies url (if only_qual_uri)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">addMIRIAMannotation</span><span class="p">(</span><span class="n">qual</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.setSharedAnnotation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.setSharedAnnotation">[docs]</a>    <span class="k">def</span> <span class="nf">setSharedAnnotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the list of members (all) annotation as a key : value pair.</span>

<span class="sd">         - *key* the annotation key</span>
<span class="sd">         - *value* the annotation value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">setAnnotation</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.setSharedSBOterm"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.setSharedSBOterm">[docs]</a>    <span class="k">def</span> <span class="nf">setSharedSBOterm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sbo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the SBO term for the the members of the group (all).</span>

<span class="sd">         - *sbo* the SBOterm with format: &quot;SBO:&lt;7 digit integer&gt;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">setSBOterm</span><span class="p">(</span><span class="n">sbo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.setSharedNotes"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.setSharedNotes">[docs]</a>    <span class="k">def</span> <span class="nf">setSharedNotes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the group of objects notes attribute (all):</span>

<span class="sd">         - *notes* the note string, should preferably be (X)HTML for SBML</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">setNotes</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.getSharedMIRIAMannotations"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.getSharedMIRIAMannotations">[docs]</a>    <span class="k">def</span> <span class="nf">getSharedMIRIAMannotations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a dictionary of the shared member MIRIAM annotations (rather than the group attribute).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">getMIRIAMannotations</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Group.getSharedAnnotations"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.getSharedAnnotations">[docs]</a>    <span class="k">def</span> <span class="nf">getSharedAnnotations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a dictionary of the shared member annotations (rather than the group attribute).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">getAnnotations</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Group.getSharedSBOterm"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.getSharedSBOterm">[docs]</a>    <span class="k">def</span> <span class="nf">getSharedSBOterm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the shared member SBO term (rather than the group attribute).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">getSBOterm</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Group.getSharedNotes"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.getSharedNotes">[docs]</a>    <span class="k">def</span> <span class="nf">getSharedNotes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the shared member notes (rather than the group attribute).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">getNotes</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Group.assignSharedAnnotationToMembers"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.assignSharedAnnotationToMembers">[docs]</a>    <span class="k">def</span> <span class="nf">assignSharedAnnotationToMembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function merges or updates the group member objects annotations with the group shared annotation.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;INFO: Assigning shared CBMPy annotation to members, this cannot be undone.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">annotation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">m_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="p">:</span>
                <span class="n">m_</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">annotation</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.assignSharedMIRIAMannotationToMembers"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.assignSharedMIRIAMannotationToMembers">[docs]</a>    <span class="k">def</span> <span class="nf">assignSharedMIRIAMannotationToMembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function merges or updates the group member objects MIRIAM annotations with the group shared MIRIAM annotation.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;INFO: Assigning shared MIRIAM annotation to members, this cannot be undone.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">miriam</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">annot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">miriam</span><span class="o">.</span><span class="n">getAllMIRIAMUris</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">m_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">k_</span> <span class="ow">in</span> <span class="n">annot</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="p">[</span><span class="n">k_</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">u_</span> <span class="ow">in</span> <span class="n">annot</span><span class="p">[</span><span class="n">k_</span><span class="p">]:</span>
                            <span class="n">m_</span><span class="o">.</span><span class="n">addMIRIAMuri</span><span class="p">(</span><span class="n">k_</span><span class="p">,</span> <span class="n">u_</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.assignSharedSBOtermsToMembers"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.assignSharedSBOtermsToMembers">[docs]</a>    <span class="k">def</span> <span class="nf">assignSharedSBOtermsToMembers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns the group shared member SBO term to the group members.</span>

<span class="sd">         - *overwrite* [default=False] overwrite the target SBO term if it is defined</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;INFO: Assigning shared SBOterm to members, this cannot be undone.&#39;</span><span class="p">)</span>
        <span class="n">sbo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">getSBOterm</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sbo</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">m_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">m_</span><span class="o">.</span><span class="n">__sbo_term__</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">overwrite</span><span class="p">:</span>
                    <span class="n">m_</span><span class="o">.</span><span class="n">setSBOterm</span><span class="p">(</span><span class="n">sbo</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.assignSharedNotesToMembers"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.assignSharedNotesToMembers">[docs]</a>    <span class="k">def</span> <span class="nf">assignSharedNotesToMembers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns the group shared notes to the group members.</span>

<span class="sd">         - *overwrite* [default=False] overwrite the target notes if they are defined</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;INFO: Assigning shared Notes to members, this cannot be undone.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">notes</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">m_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">m_</span><span class="o">.</span><span class="n">notes</span> <span class="o">==</span> <span class="s">&#39;&#39;</span> <span class="ow">or</span> <span class="n">overwrite</span><span class="p">:</span>
                    <span class="n">m_</span><span class="o">.</span><span class="n">notes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_member_attributes_</span><span class="o">.</span><span class="n">notes</span>
</div>
<div class="viewcode-block" id="Group.assignAllSharedPropertiesToMembers"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Group.assignAllSharedPropertiesToMembers">[docs]</a>    <span class="k">def</span> <span class="nf">assignAllSharedPropertiesToMembers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns all group shared properties (notes, annotations, MIRIAM annotations, SBO) to the group members.</span>

<span class="sd">         - *overwrite* [default=False] overwrite the target notes if they are defined</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assignSharedSBOtermsToMembers</span><span class="p">(</span><span class="n">overwrite</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assignSharedNotesToMembers</span><span class="p">(</span><span class="n">overwrite</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assignSharedAnnotationToMembers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assignSharedMIRIAMannotationToMembers</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="FluxBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.FluxBound">[docs]</a><span class="k">class</span> <span class="nc">FluxBound</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A reaction fluxbound&quot;&quot;&quot;</span>
    <span class="n">reaction</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">value</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">is_bound</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__param__</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fid</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">fid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">reaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">operation</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;greater&#39;</span><span class="p">,</span> <span class="s">&#39;greaterEqual&#39;</span><span class="p">,</span> <span class="s">&#39;less&#39;</span><span class="p">,</span> <span class="s">&#39;lessEqual&#39;</span><span class="p">,</span> <span class="s">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="s">&#39;equal&#39;</span><span class="p">,</span> <span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="s">&#39;G&#39;</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">,</span> <span class="s">&#39;GE&#39;</span><span class="p">,</span> <span class="s">&#39;LE&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="n">operation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;greater&#39;</span><span class="p">,</span> <span class="s">&#39;greaterEqual&#39;</span><span class="p">,</span> <span class="s">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="s">&#39;G&#39;</span><span class="p">,</span> <span class="s">&#39;GE&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="s">&#39;greaterEqual&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_bound</span> <span class="o">=</span> <span class="s">&#39;lower&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;less&#39;</span><span class="p">,</span> <span class="s">&#39;lessEqual&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">,</span> <span class="s">&#39;LE&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_bound</span> <span class="o">=</span> <span class="s">&#39;upper&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="s">&#39;lessEqual&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_bound</span> <span class="o">=</span> <span class="s">&#39;equality&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="s">&#39;equal&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartment</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__delattr__</span><span class="p">(</span><span class="s">&#39;compartment&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="FluxBound.getType"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.FluxBound.getType">[docs]</a>    <span class="k">def</span> <span class="nf">getType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the *type* of FluxBound: &#39;lower&#39;, &#39;upper&#39;, &#39;equality&#39; or None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;greater&#39;</span><span class="p">,</span> <span class="s">&#39;greaterEqual&#39;</span><span class="p">,</span> <span class="s">&#39;&gt;=&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_bound</span> <span class="o">=</span> <span class="s">&#39;lower&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;less&#39;</span><span class="p">,</span> <span class="s">&#39;lessEqual&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;=&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_bound</span> <span class="o">=</span> <span class="s">&#39;upper&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;equal&#39;</span><span class="p">,</span> <span class="s">&#39;equality&#39;</span><span class="p">,</span> <span class="s">&#39;=&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_bound</span> <span class="o">=</span> <span class="s">&#39;equality&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bound</span>
</div>
    <span class="k">def</span> <span class="nf">getReactionId</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span>

<div class="viewcode-block" id="FluxBound.setReactionId"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.FluxBound.setReactionId">[docs]</a>    <span class="k">def</span> <span class="nf">setReactionId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">react</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the reaction attribute of the FluxBound</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">react</span>
</div>
<div class="viewcode-block" id="FluxBound.getValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.FluxBound.getValue">[docs]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current value of the attribute (input/solution)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</div>
<div class="viewcode-block" id="FluxBound.setValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.FluxBound.setValue">[docs]</a>    <span class="k">def</span> <span class="nf">setValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the attribute &#39;&#39;value&#39;&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="Parameter"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Parameter">[docs]</a><span class="k">class</span> <span class="nc">Parameter</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Holds parameter information&quot;&quot;&quot;</span>

    <span class="n">_association_</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">constant</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">value</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameter definition class</span>

<span class="sd">         - *pid* the unique parameter pid</span>
<span class="sd">         - *value* the value</span>
<span class="sd">         - *name* [default=&#39;&#39;] the parameter name</span>
<span class="sd">         - *constant* [default=True] is the paramter constant (an SBML thing)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="n">constant</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_association_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="Parameter.getValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Parameter.getValue">[docs]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current value of the attribute (input/solution)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</div>
<div class="viewcode-block" id="Parameter.setValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Parameter.setValue">[docs]</a>    <span class="k">def</span> <span class="nf">setValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the attribute &#39;&#39;value&#39;&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Parameter.getAssociations"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Parameter.getAssociations">[docs]</a>    <span class="k">def</span> <span class="nf">getAssociations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the FluxBounds ID&#39;s associated with this object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_association_</span>
</div>
<div class="viewcode-block" id="Parameter.addAssociation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Parameter.addAssociation">[docs]</a>    <span class="k">def</span> <span class="nf">addAssociation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assoc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a fluxbound ID&#39;s to associate with this object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_association_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assoc</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Parameter.deleteAssociation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Parameter.deleteAssociation">[docs]</a>    <span class="k">def</span> <span class="nf">deleteAssociation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assoc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the fluxbound id associated with this object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_association_</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_association_</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_association_</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">assoc</span><span class="p">))</span>
</div></div>
<div class="viewcode-block" id="Reaction"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction">[docs]</a><span class="k">class</span> <span class="nc">Reaction</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Holds reaction information&quot;&quot;&quot;</span>
    <span class="n">reagents</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">reversible</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">is_exchange</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">value</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">reduced_cost</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">is_balanced</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">fva_min</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">fva_max</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">fva_status</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__bound_history__</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__is_active__</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">reversible</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reversible</span> <span class="o">=</span> <span class="n">reversible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__bound_history__</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="Reaction.addReagent"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.addReagent">[docs]</a>    <span class="k">def</span> <span class="nf">addReagent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reag</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds an instantiated Reagent object to the reaction</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reag</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Reaction.createReagent"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.createReagent">[docs]</a>    <span class="k">def</span> <span class="nf">createReagent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metabolite</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new reagent and add it to the reaction:</span>

<span class="sd">         - **metabolite** the metabolite name</span>
<span class="sd">         - **coefficient** the</span>

<span class="sd">         -- negative coefficient is a substrate</span>
<span class="sd">         -- positive coefficient is a product</span>

<span class="sd">        Will fail if a species reference already exists</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">metabolite</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">(),</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">A reagent already refers to metabolite: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">metabolite</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addReagent</span><span class="p">(</span><span class="n">Reagent</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getPid</span><span class="p">(),</span> <span class="n">metabolite</span><span class="p">),</span> <span class="n">metabolite</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Reaction.getReagentObjIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getReagentObjIds">[docs]</a>    <span class="k">def</span> <span class="nf">getReagentObjIds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of the reagent id&#39;s. For the name of the reagents/metabolites use *&lt;reaction&gt;.getSpeciesIds()*</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Reaction.getReagentRefs"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getReagentRefs">[docs]</a>    <span class="k">def</span> <span class="nf">getReagentRefs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of the reagents/metabolites</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">DEPRECATED: please use &lt;reaction&gt;.getSpeciesIds&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Reaction.getSpeciesIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getSpeciesIds">[docs]</a>    <span class="k">def</span> <span class="nf">getSpeciesIds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of the reagents/metabolites</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Reaction.getSpeciesObj"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getSpeciesObj">[docs]</a>    <span class="k">def</span> <span class="nf">getSpeciesObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of the species objects that are reagents</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;INFO: Only works when part of a model.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="Reaction.getFVAdata"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getFVAdata">[docs]</a>    <span class="k">def</span> <span class="nf">getFVAdata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roundnum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the data generated by CBSolver.FluxVariabilityAnalysis() for this reaction as a tuple of</span>
<span class="sd">        (Flux, FVAmin, FVAmax, span) where span is abs(FVAmax - FVAmin). FVAmin or FVAmax is None this indicates no solution</span>
<span class="sd">        to that particular optimization (infeasible).</span>

<span class="sd">         - *roundnum* [default=None] the integer number of roundoff decimals the default is no rounding</span>
<span class="sd">         - *silent* [default=True] supress output to stdout</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">span</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fva_max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fva_min</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">span</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">NaN</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fva_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fva_max</span><span class="p">,</span> <span class="n">span</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">roundnum</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">f_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">out</span><span class="p">[</span><span class="n">f_</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">f_</span><span class="p">],</span> <span class="n">roundnum</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getPid</span><span class="p">()))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Flux:   {}</span><span class="se">\n</span><span class="s">FVAmin: {}</span><span class="se">\n</span><span class="s">FVAmax: {}</span><span class="se">\n</span><span class="s">Span:   {}</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Reaction.getReagent"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getReagent">[docs]</a>    <span class="k">def</span> <span class="nf">getReagent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the one or more reagent objects which have *rid*:</span>

<span class="sd">         - *rid* a reagent *rid*</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rgnt</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="o">==</span> <span class="n">rid</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgnt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgnt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">rgnt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Warning multiple reagents defined for species: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rid</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">rgnt</span>
</div>
<div class="viewcode-block" id="Reaction.changeId"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.changeId">[docs]</a>    <span class="k">def</span> <span class="nf">changeId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the Id of the reaction and updates associated FluxBounds</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">fb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getFluxBoundsByReactionID</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getId</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">fb</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">fb</span><span class="o">.</span><span class="n">setReactionId</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPid</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Reaction.getValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getValue">[docs]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current value of the flux.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</div>
<div class="viewcode-block" id="Reaction.setValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.setValue">[docs]</a>    <span class="k">def</span> <span class="nf">setValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the attribute *value* in this case the flux.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</div>
<div class="viewcode-block" id="Reaction.getReagentWithSpeciesRef"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getReagentWithSpeciesRef">[docs]</a>    <span class="k">def</span> <span class="nf">getReagentWithSpeciesRef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the reagent object which refers to the *species* id:</span>

<span class="sd">         - *species* the species/metabolite id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rgnt</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">species_ref</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgnt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgnt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">rgnt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Warning multiple reagents defined for species: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">species</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">rgnt</span>
</div>
<div class="viewcode-block" id="Reaction.changeReagentCoefficientForSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.changeReagentCoefficientForSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">changeReagentCoefficientForSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_id</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the coefficient of reagent which refers to s_id. If there is more than one reagent that refers</span>
<span class="sd">        to this species return a warning and a list of reagents otherwise None.</span>

<span class="sd">         - *s_id* a species/metabolite id</span>
<span class="sd">         - *coefficient* the new coefficient</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">RuntimeWarning</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">DEPRECATED: please use &lt;reaction&gt;.setStoichCoefficient&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Reaction.setStoichCoefficient"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.setStoichCoefficient">[docs]</a>    <span class="k">def</span> <span class="nf">setStoichCoefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sid</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the stoichiometric coefficient of a reagent that refers to a metabolite. Note *negative coefficients* are *substrates*</span>
<span class="sd">        while *positive* ones are *products*. At this point zero coefficients are not allowed</span>

<span class="sd">        - *sid* the species/metabolite id</span>
<span class="sd">        - *value* a floating point value != 0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;WARNING: for now a coefficient cannot be set to zero&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReagentWithSpeciesRef</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">S</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">S</span><span class="o">.</span><span class="n">setCoefficient</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Reaction.getStoichiometry"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getStoichiometry">[docs]</a>    <span class="k">def</span> <span class="nf">getStoichiometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_names</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">altout</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of (coefficient, species) pairs for this reaction</span>

<span class="sd">        - *use_names* [default = False] use species names rather than id&#39;s</span>
<span class="sd">        - *altout* [default = False] returns a dictionary</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">use_names</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">[(</span><span class="n">r</span><span class="o">.</span><span class="n">coefficient</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">altout</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">out</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out2</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
                    <span class="n">out2</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">out2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">[(</span><span class="n">r</span><span class="o">.</span><span class="n">coefficient</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">altout</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">out</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out2</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
                    <span class="n">out2</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">out2</span>

</div>
<div class="viewcode-block" id="Reaction.getSubstrateIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getSubstrateIds">[docs]</a>    <span class="k">def</span> <span class="nf">getSubstrateIds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of the reaction substrates, species identifiers</span>

<span class="sd">        - *use_names* [defualt = False] use species names rather than id&#39;s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">use_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Reaction.getProductIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getProductIds">[docs]</a>    <span class="k">def</span> <span class="nf">getProductIds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of the reaction products, species identifiers</span>

<span class="sd">        - *use_names* [defualt = False] use species names rather than id&#39;s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">use_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Reaction.deleteReagentWithSpeciesRef"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.deleteReagentWithSpeciesRef">[docs]</a>    <span class="k">def</span> <span class="nf">deleteReagentWithSpeciesRef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete a reagent that refers to the species id:</span>

<span class="sd">         - *species* a species/metabolite id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">species</span> <span class="ow">in</span> <span class="n">rids</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Thats not a good matabolite/species ref&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span><span class="o">+</span><span class="n">species</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">rids</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">species</span><span class="p">))})</span>
</div>
<div class="viewcode-block" id="Reaction.undeleteReagentWithSpeciesRef"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.undeleteReagentWithSpeciesRef">[docs]</a>    <span class="k">def</span> <span class="nf">undeleteReagentWithSpeciesRef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Attempts to unDelete reagent deleted with deleteReagent() that refers to the species id:</span>

<span class="sd">         - *species* a species/metabolite id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span><span class="o">+</span><span class="n">species</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Aha, yes, sure, maybe, perhaps ...&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__TRASH__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span><span class="o">+</span><span class="n">species</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Reaction.getLowerBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getLowerBound">[docs]</a>    <span class="k">def</span> <span class="nf">getLowerBound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the value of the reactions lower bound</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getReactionLowerBound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">why</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;WARNING: This function requires that this reaction object be added to a CBMPy instance to work.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="Reaction.getUpperBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getUpperBound">[docs]</a>    <span class="k">def</span> <span class="nf">getUpperBound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the value of the reactions upper bound</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getReactionUpperBound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">why</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;WARNING: This function requires that this reaction object be added to a CBMPy instance to work.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="Reaction.setLowerBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.setLowerBound">[docs]</a>    <span class="k">def</span> <span class="nf">setLowerBound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the value of the reactions lower bound</span>

<span class="sd">         - *value* a floating point value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">setReactionLowerBound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">why</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;WARNING: This function requires that this reaction object be added to a CBMPy instance to work.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Reaction.setUpperBound"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.setUpperBound">[docs]</a>    <span class="k">def</span> <span class="nf">setUpperBound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the value of the reactions upper bound</span>

<span class="sd">         - *value* a floating point value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">setReactionUpperBound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">why</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;WARNING: This function requires that this reaction object be added to a CBMPy instance to work.&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Reaction.deactivateReaction"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.deactivateReaction">[docs]</a>    <span class="k">def</span> <span class="nf">deactivateReaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deactivates a reaction by setting its bounds to lower and upper. Restore with reactivateReaction()</span>

<span class="sd">         - *lower* [default=0.0] bound</span>
<span class="sd">         - *upper* [default=0.0] bound</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__bound_history__</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">lb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLowerBound</span><span class="p">()</span>
        <span class="n">ub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUpperBound</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__bound_history__</span> <span class="o">=</span> <span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLowerBound</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setUpperBound</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__is_active__</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Reaction {} bounds set to [{} : {}]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Reaction.reactivateReaction"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.reactivateReaction">[docs]</a>    <span class="k">def</span> <span class="nf">reactivateReaction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Activates a reaction deactivated with deactivateReaction</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__bound_history__</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setLowerBound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__bound_history__</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setUpperBound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__bound_history__</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Reaction {} bounds set to [{} : {}]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__bound_history__</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__bound_history__</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__bound_history__</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__is_active__</span> <span class="o">=</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="Reaction.getEquation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reaction.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse_symb</span><span class="o">=</span><span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="n">irreverse_symb</span><span class="o">=</span><span class="s">&#39;&gt;&#39;</span><span class="p">,</span> <span class="n">use_names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a pretty printed string containing the reaction equation</span>

<span class="sd">         - *reverse_symb* [default = &#39;=&#39;] the symbol to use for reversible reactions</span>
<span class="sd">         - *irreverse_symb* [default = &#39;&gt;&#39;] the symbol to use for irreversible reactions</span>
<span class="sd">         - *use_names* [defualt = False] use species names rather than id&#39;s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="n">prod</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagents</span><span class="p">:</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">coefficient</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">role</span> <span class="o">==</span> <span class="s">&#39;substrate&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">coeff</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">use_names</span><span class="p">:</span>
                        <span class="n">sub</span> <span class="o">+=</span> <span class="s">&#39;{} + &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sub</span> <span class="o">+=</span> <span class="s">&#39;{} + &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">use_names</span><span class="p">:</span>
                        <span class="n">sub</span> <span class="o">+=</span> <span class="s">&#39;({}) {} + &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sub</span> <span class="o">+=</span> <span class="s">&#39;({}) {} + &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">coeff</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">use_names</span><span class="p">:</span>
                        <span class="n">prod</span> <span class="o">+=</span> <span class="s">&#39;{} + &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">prod</span> <span class="o">+=</span> <span class="s">&#39;{} + &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">use_names</span><span class="p">:</span>
                        <span class="n">prod</span> <span class="o">+=</span> <span class="s">&#39;({}) {} + &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">prod</span> <span class="o">+=</span> <span class="s">&#39;({}) {} + &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">species_ref</span><span class="p">)</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversible</span><span class="p">:</span>
            <span class="n">eq</span> <span class="o">=</span> <span class="s">&#39;{} {} {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sub</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">reverse_symb</span><span class="p">,</span> <span class="n">prod</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eq</span> <span class="o">=</span> <span class="s">&#39;{} {} {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sub</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">irreverse_symb</span><span class="p">,</span> <span class="n">prod</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">eq</span>
</div></div>
<div class="viewcode-block" id="Species"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species">[docs]</a><span class="k">class</span> <span class="nc">Species</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Holds species/metabolite information</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chemFormula</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">value</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">is_boundary</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">reagent_of</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">shadow_price</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s">&#39;nan&#39;</span><span class="p">),</span>\
                    <span class="n">compartment</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">chemFormula</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Species/metabolite definition class</span>

<span class="sd">         - **pid** the unique species pid</span>
<span class="sd">         - **boundary** [default=False] whether the species is a variable (False) or is a boundary parameter (fixed)</span>
<span class="sd">         - **name** [default=&#39;&#39;] the species name</span>
<span class="sd">         - **value** [default=nan] the value *not currently used*</span>
<span class="sd">         - **compartment** [default=None] the compartment the species is located in</span>
<span class="sd">         - **charge** [default=None] the species charge</span>
<span class="sd">         - **chemFormula** [default=None] the chemical formula</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_boundary</span> <span class="o">=</span> <span class="n">boundary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartment</span> <span class="o">=</span> <span class="n">compartment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chemFormula</span> <span class="o">=</span> <span class="n">chemFormula</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reagent_of</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="Species.getValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.getValue">[docs]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current value of the attribute (input/solution)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</div>
<div class="viewcode-block" id="Species.setValue"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.setValue">[docs]</a>    <span class="k">def</span> <span class="nf">setValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the attribute &#39;&#39;value&#39;&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</div>
<div class="viewcode-block" id="Species.isReagentOf"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.isReagentOf">[docs]</a>    <span class="k">def</span> <span class="nf">isReagentOf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dynamically generated list of reactions that this species occurs as a reagent</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">WARNING: needs to be added to a model (cmod.addSpecies()) to work&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reagent_of</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">reactions</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">getSpeciesIds</span><span class="p">()]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagent_of</span>
</div>
<div class="viewcode-block" id="Species.getReagentOf"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.getReagentOf">[docs]</a>    <span class="k">def</span> <span class="nf">getReagentOf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of reaction id&#39;s that this metabolite occurs in</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;INFO: The static .getReagentOf() method will be deprecated, please update your code to use: </span><span class="se">\&quot;</span><span class="s">.isReagentOf()</span><span class="se">\&quot;</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagent_of</span>
</div>
<div class="viewcode-block" id="Species.setReagentOf"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.setReagentOf">[docs]</a>    <span class="k">def</span> <span class="nf">setReagentOf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the supplied reaction id to the reagent_of list (if it isn&#39;t one already)</span>

<span class="sd">         - *rid* a valid reaction id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reagent_of</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reagent_of</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Species.setChemFormula"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.setChemFormula">[docs]</a>    <span class="k">def</span> <span class="nf">setChemFormula</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cf</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the species chemical formula</span>

<span class="sd">         - *cf* a chemical formula e.g. CH3NO2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">checkChemFormula</span><span class="p">(</span><span class="n">cf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chemFormula</span> <span class="o">=</span> <span class="n">cf</span>
        <span class="c">#if checkChemFormula(cf):</span>
            <span class="c">#self.chemFormula = cf</span>
        <span class="c">#else:</span>
            <span class="c">#self.chemFormula = &#39;&#39;</span>
</div>
<div class="viewcode-block" id="Species.getChemFormula"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.getChemFormula">[docs]</a>    <span class="k">def</span> <span class="nf">getChemFormula</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the species chemical formula</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemFormula</span>
</div>
<div class="viewcode-block" id="Species.setCharge"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.setCharge">[docs]</a>    <span class="k">def</span> <span class="nf">setCharge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">charge</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the species charge:</span>

<span class="sd">         - *charge* a signed double but generally a signed int is used</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">charge</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">charge</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span>
</div>
<div class="viewcode-block" id="Species.getCharge"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.getCharge">[docs]</a>    <span class="k">def</span> <span class="nf">getCharge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the species charge</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span>
</div>
<div class="viewcode-block" id="Species.setBoundary"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.setBoundary">[docs]</a>    <span class="k">def</span> <span class="nf">setBoundary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the species so it is a boundary metabolite or fixed which does not occur in the stoichiometric matrix N</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_boundary</span> <span class="o">=</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="Species.unsetBoundary"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Species.unsetBoundary">[docs]</a>    <span class="k">def</span> <span class="nf">unsetBoundary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unsets the species boundary attribute so that the metabolite is free and therefore occurs in the stoichiometric matrix N</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_boundary</span> <span class="o">=</span> <span class="bp">False</span>

</div></div>
<div class="viewcode-block" id="Reagent"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reagent">[docs]</a><span class="k">class</span> <span class="nc">Reagent</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Has a reactive species id and stoichiometric coefficient:</span>
<span class="sd">     - negative = substrate</span>
<span class="sd">     - positive = product</span>
<span class="sd">     - species_ref a reference to a species obj</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coefficient</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">role</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">species_ref</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reid</span><span class="p">,</span> <span class="n">species_ref</span><span class="p">,</span> <span class="n">coef</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiates a reagent</span>

<span class="sd">         - *reid* a unique id</span>
<span class="sd">         - *species_ref* a reference to a species id</span>
<span class="sd">         - *coefficient* the metabolite coefficient</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">reid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species_ref</span> <span class="o">=</span> <span class="n">species_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">=</span> <span class="n">coef</span>
        <span class="k">if</span> <span class="n">coef</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">role</span> <span class="o">=</span> <span class="s">&#39;product&#39;</span>
        <span class="k">elif</span> <span class="n">coef</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">role</span> <span class="o">=</span> <span class="s">&#39;substrate&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Zero coefficients are not supported for now: {</span><span class="si">%s</span><span class="s">}</span><span class="si">%s</span><span class="s">!&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">reid</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compartment</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__delattr__</span><span class="p">(</span><span class="s">&#39;compartment&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Reagent.setCoefficient"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reagent.setCoefficient">[docs]</a>    <span class="k">def</span> <span class="nf">setCoefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coef</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the reagent coefficient and role, negative coefficients are substrates and positive ones are products</span>

<span class="sd">         - *coeff* the new coefficient</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">=</span> <span class="n">coef</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">role</span> <span class="o">=</span> <span class="s">&#39;substrate&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">role</span> <span class="o">=</span> <span class="s">&#39;product&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">role</span> <span class="o">=</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="Reagent.getCoefficient"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reagent.getCoefficient">[docs]</a>    <span class="k">def</span> <span class="nf">getCoefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the reagent coefficient</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span>
</div>
<div class="viewcode-block" id="Reagent.setSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reagent.setSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">setSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spe</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the metabolite/species that the reagent reference refers to</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species_ref</span> <span class="o">=</span> <span class="n">spe</span>
</div>
<div class="viewcode-block" id="Reagent.getSpecies"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reagent.getSpecies">[docs]</a>    <span class="k">def</span> <span class="nf">getSpecies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the metabolite/species that the reagent reference refers to</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_ref</span>
</div>
<div class="viewcode-block" id="Reagent.getRole"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Reagent.getRole">[docs]</a>    <span class="k">def</span> <span class="nf">getRole</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the reagents role, &quot;substrate&quot;, &quot;product&quot; or None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#if self.coefficient &lt; 0.0:</span>
            <span class="c">#self.role = &#39;substrate&#39;</span>
        <span class="c">#elif self.coefficient &gt; 0.0:</span>
            <span class="c">#self.role = &#39;product&#39;</span>
        <span class="c">#else:</span>
            <span class="c">#self.role = None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">role</span>
</div></div>
<div class="viewcode-block" id="Gene"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Gene">[docs]</a><span class="k">class</span> <span class="nc">Gene</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Contains all the information about a gene (or gene+protein construct depending on your philosophy)</span>

<span class="sd">    TODO: I will change the whole Gene/GPR structure to a dictionary data structure on the model which should simplify this all significantly.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">active0</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">active</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">label</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A gene construct</span>

<span class="sd">         - *gid* the gene id</span>
<span class="sd">         - *label* the gene label this may or may not be a legal Sid</span>
<span class="sd">         - *active* is the gene is active or not (boolean)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setId</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">gid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active0</span> <span class="o">=</span> <span class="n">active</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="n">active</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="Gene.getLabel"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Gene.getLabel">[docs]</a>    <span class="k">def</span> <span class="nf">getLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the gene label</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span>
</div>
<div class="viewcode-block" id="Gene.setLabel"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Gene.setLabel">[docs]</a>    <span class="k">def</span> <span class="nf">setLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the gene label</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
</div>
<div class="viewcode-block" id="Gene.setActive"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Gene.setActive">[docs]</a>    <span class="k">def</span> <span class="nf">setActive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the gene to be active</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="Gene.setInactive"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Gene.setInactive">[docs]</a>    <span class="k">def</span> <span class="nf">setInactive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the gene to be inactive</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="bp">False</span>
</div>
<div class="viewcode-block" id="Gene.isActive"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Gene.isActive">[docs]</a>    <span class="k">def</span> <span class="nf">isActive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns whether the gene is active or not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span>
</div>
<div class="viewcode-block" id="Gene.resetActivity"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.Gene.resetActivity">[docs]</a>    <span class="k">def</span> <span class="nf">resetActivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset the gene to its default activity state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active0</span>

</div></div>
<div class="viewcode-block" id="GeneProteinAssociation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation">[docs]</a><span class="k">class</span> <span class="nc">GeneProteinAssociation</span><span class="p">(</span><span class="n">Fbase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class associates genes to proteins.</span>
<span class="sd">    TODO: I will change the whole Gene/GPR structure to a dictionary data structure on the model which should simplify this all significantly.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#_MODIFIED_ASSOCIATION_ = False</span>
    <span class="n">assoc</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="c">#assoc0 = None</span>
    <span class="n">protein</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">__evalass__</span> <span class="o">=</span> <span class="s">&#39;None&#39;</span>
    <span class="n">__evalass_ids__</span> <span class="o">=</span> <span class="s">&#39;None&#39;</span>
    <span class="n">__evalass_names__</span> <span class="o">=</span> <span class="s">&#39;None&#39;</span>
    <span class="n">generefs</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpid</span><span class="p">,</span> <span class="n">protein</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a GeneProteinAssociation</span>

<span class="sd">         - *gpid* a unique id</span>
<span class="sd">         - *protein* the protein the gene association referes to, in most cases this should be a reaction id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPid</span><span class="p">(</span><span class="n">gpid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">protein</span> <span class="o">=</span> <span class="n">protein</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="GeneProteinAssociation.evalAssociation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.evalAssociation">[docs]</a>    <span class="k">def</span> <span class="nf">evalAssociation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an integer value representing the logical associations or None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">_model_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">SyntaxError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeWarning</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Error in GPR associated with reaction: </span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">protein</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">assoc</span><span class="p">))</span>
        <span class="k">del</span> <span class="n">_model_</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.addGeneref"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.addGeneref">[docs]</a>    <span class="k">def</span> <span class="nf">addGeneref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geneid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a gene reference to the list of gene references</span>

<span class="sd">         - *geneid* a valid model Gene id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">geneid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geneid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.deleteGeneref"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.deleteGeneref">[docs]</a>    <span class="k">def</span> <span class="nf">deleteGeneref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes a gene reference</span>

<span class="sd">        - *geneid* a valid model Gene id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">gid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.addAssociation"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.addAssociation">[docs]</a>    <span class="k">def</span> <span class="nf">addAssociation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assoc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a gene/protein association expression</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assoc</span> <span class="o">=</span> <span class="n">assoc</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.createAssociationAndGeneRefs"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.createAssociationAndGeneRefs">[docs]</a>    <span class="k">def</span> <span class="nf">createAssociationAndGeneRefs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assoc</span><span class="p">,</span> <span class="n">altlabels</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate the gene/protein association and add the genes necessary to evaluate it</span>
<span class="sd">        Note that this GPR should be added to a model with cmod.addGPRAssociation() before calling this method</span>

<span class="sd">         - *assoc* the COBRA style gene protein association</span>
<span class="sd">         - *altlabels* [default=None] a dictionary containing a label&lt;--&gt;id mapping</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Please add this GeneAssociation to a model with cmod.addGPRAssociation() before calling this method!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">altlabels</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">altlabels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">genelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">genes</span>
        <span class="n">mod_genes</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">getPid</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">genelist</span><span class="p">]</span>
        <span class="c">#self.assoc = self.assoc0 = assoc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assoc</span> <span class="o">=</span> <span class="n">assoc</span>
        <span class="n">react_gene</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c">#gene_re = re.compile(gene_pattern)</span>
        <span class="c">##  print &#39;assoc\n&#39;, assoc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">assoc</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">assoc</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="n">genes</span> <span class="o">=</span> <span class="n">extractGeneIdsFromString</span><span class="p">(</span><span class="n">assoc</span><span class="p">)</span>
            <span class="c">#print(genes)</span>
            <span class="c">#geneLabels = []</span>
            <span class="c">#for g_ in genes:</span>
                <span class="c">#if not checkId(s)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">genes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">gid</span> <span class="ow">in</span> <span class="n">genes</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">gid</span> <span class="ow">in</span> <span class="n">altlabels</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">altlabels</span><span class="p">[</span><span class="n">gid</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">gid</span>
                    <span class="c">#if not checkId(gid):</span>
                        <span class="c">#gid2 = fixId(gid, replace=&#39;_&#39;)</span>
                        <span class="c">#self.assoc = self.assoc.replace(gid, gid2)</span>
                        <span class="c">#self._MODIFIED_ASSOCIATION_ = True</span>
                        <span class="c">#print(&#39;Incompatible geneId \&quot;{}\&quot; replacing with \&quot;{}\&quot;\n{}\n{}&#39;.format(gid, gid2, self.assoc0, self.assoc))</span>
                        <span class="c">#gid = gid2</span>
                    <span class="k">if</span> <span class="n">gid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">elif</span> <span class="n">gid</span> <span class="ow">in</span> <span class="n">mod_genes</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">addGeneref</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">genelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Gene</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">addGeneref</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">__updateGeneIdx__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buildEvalFunc</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.buildEvalFunc"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.buildEvalFunc">[docs]</a>    <span class="k">def</span> <span class="nf">buildEvalFunc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds a function which evaluates the gene expressions and evaluates to an integer uisng</span>
<span class="sd">        the following rules:</span>

<span class="sd">         - True --&gt; 1</span>
<span class="sd">         - False --&gt; 0</span>
<span class="sd">         - and --&gt; *</span>
<span class="sd">         - or --&gt; +</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGeneIds</span><span class="p">()</span>
        <span class="c">##  print gids</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assoc</span>
            <span class="n">_model_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span>
            <span class="c"># this is to avoid substring replacements</span>
            <span class="n">gids</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">gids</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">)</span>
            <span class="n">gids</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gids</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s">&quot;_model_.genes[{}].isActive()&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_model_</span><span class="o">.</span><span class="n">__genes_idx__</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">g</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; or &#39;</span><span class="p">,</span> <span class="s">&#39; + &#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; OR &#39;</span><span class="p">,</span> <span class="s">&#39; + &#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; and &#39;</span><span class="p">,</span> <span class="s">&#39; * &#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; AND &#39;</span><span class="p">,</span> <span class="s">&#39; * &#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span> <span class="o">=</span> <span class="s">&#39;int(</span><span class="si">%s</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__evalass__</span>
            <span class="k">del</span> <span class="n">_model_</span>
            <span class="c">#self.__evalass__ = compile(self.__evalass__, &#39;GeneAss&#39;, &#39;exec&#39;)</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.getGenes"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.getGenes">[docs]</a>    <span class="k">def</span> <span class="nf">getGenes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of gene objects associated with this GPRass</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getGene</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.getGene"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.getGene">[docs]</a>    <span class="k">def</span> <span class="nf">getGene</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a gene object with id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">gid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getGene</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;WARNING: {} is not a valid gene id&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gid</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.getAssociationStr"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.getAssociationStr">[docs]</a>    <span class="k">def</span> <span class="nf">getAssociationStr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return the gene association string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#if self._MODIFIED_ASSOCIATION_:</span>
            <span class="c">#print(&#39;NOTE: this association string has been modified to be evaluable:\n{} --&gt; {}&#39;.format(self.assoc0, self.assoc))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assoc</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.getGeneIds"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.getGeneIds">[docs]</a>    <span class="k">def</span> <span class="nf">getGeneIds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of gene id&#39;s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.getActiveGenes"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.getActiveGenes">[docs]</a>    <span class="k">def</span> <span class="nf">getActiveGenes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of active gene objects</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span><span class="p">:</span>
            <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getGene</span><span class="p">(</span><span class="n">g_</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">G</span><span class="o">.</span><span class="n">isActive</span><span class="p">():</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.getProtein"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.getProtein">[docs]</a>    <span class="k">def</span> <span class="nf">getProtein</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the protein associated with this set of genes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">protein</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.setGeneInactive"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.setGeneInactive">[docs]</a>    <span class="k">def</span> <span class="nf">setGeneInactive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a gene to be inactive</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getGene</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span><span class="o">.</span><span class="n">setInactive</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Gene {} does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gid</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.setGeneActive"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.setGeneActive">[docs]</a>    <span class="k">def</span> <span class="nf">setGeneActive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a gene to be inactive</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getGene</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span><span class="o">.</span><span class="n">setActive</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Gene {} does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gid</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.setAllGenesActive"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.setAllGenesActive">[docs]</a>    <span class="k">def</span> <span class="nf">setAllGenesActive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Activate all genes in association</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span><span class="p">:</span>
            <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getGene</span><span class="p">(</span><span class="n">g_</span><span class="p">)</span>
            <span class="n">G</span><span class="o">.</span><span class="n">setActive</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.setAllGenesInactive"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.setAllGenesInactive">[docs]</a>    <span class="k">def</span> <span class="nf">setAllGenesInactive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deactivates all genes in association</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generefs</span><span class="p">:</span>
            <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objref__</span><span class="p">()</span><span class="o">.</span><span class="n">getGene</span><span class="p">(</span><span class="n">g_</span><span class="p">)</span>
            <span class="n">G</span><span class="o">.</span><span class="n">setInactive</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GeneProteinAssociation.isProteinActive"><a class="viewcode-back" href="../../modules_doc.html#cbmpy.CBModel.GeneProteinAssociation.isProteinActive">[docs]</a>    <span class="k">def</span> <span class="nf">isProteinActive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This returns a boolean which indicates the result of evaluating the gene association. If the result is positive</span>
<span class="sd">        then the protein is expressed and *True* is returned, otherwise if the expression evaluates to a value of 0 then</span>
<span class="sd">        the protein is not expressed and  *False* is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evalAssociation</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../cbmpy.html">
              <img class="logo" src="../../_static/pysces_cbm1_head.jpg" alt="Logo"/>
            </a></p><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../cbmpy.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2010-2016, Brett G. Olivier.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
    </div>

    

    
  </body>
</html>